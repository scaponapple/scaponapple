<html xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DoD Consensus Settings for Mac OS X 10.9 and 10.10</title>
</head>
<body>
<div class="tabletitle">
<i>WORKING DRAFT</i><p></p>DoD Consensus Settings for Mac OS X 10.9 and 10.10<p></p>
<i>Configurable Items</i>
</div>
<style type="text/css">
		table
		{
			border-collapse:collapse;
		}
		table, th, td
		{
			border: 2px solid #dcdcdc;
			border-left: none;
			border-right: none;
			vertical-align: top;
			padding: 2px;
			font-family: verdana,arial,sans-serif;
			font-size:11px;
		}
		pre { 
			white-space: pre-wrap;
			white-space: -moz-pre-wrap !important;
			word-wrap:break-word; 
		}
		table tr:nth-child(2n+2) { background-color: #f4f4f4; }
		thead
		{
			display: table-header-group;
			font-weight: bold;
			background-color: #dedede;
		}
		div.tabletitle
		{
			font-family: verdana,arial,sans-serif;
			font-size: x-large; 
			font-weight: bold;
			text-align: center; 
			padding: 2em 1em 1em 1em;
		}
	</style>
<table>
<thead>
<td>Title</td>
<td>VulDiscussion</td>
<td>Check</td>
<td>Yosemite Check</td>
<td>Fix</td>
<td>Yosemite Fix</td>
<td>Severity</td>
<td>NIST<p></p>Control</td>
</thead>
<tr></tr>
<tr></tr>
<tr>
<td>Apply Configuration Settings With a Configuration Profile</td>
<td>Configuration settings must be verified by a centrally managed system such as an MDM to ensure that they have not been changed. Configuration settings are the configurable security-related parameters of information technology products that are part of the information system. Security-related parameters are those parameters impacting the security state of the system including parameters related to meeting other security control requirements. Rather than visiting each and every system when verifying configuration changes, organizations will employ automated tools that can make changes across all systems.  This greatly increases efficiency and manageability of applications in a large scale environment.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the computer has a configuration profile applied to the workstation, run the following command:<p></p><p></p>sudo profiles -H<p></p><p></p>If there are no profiles installed, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Obtain a configuration profile from an MDM or trusted provider containing the configuration settings required to be applied.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 (1)</td>
</tr>
<tr>
<td>Lock User Accounts after Three Failed Login Attempts</td>
<td>By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account. Setting a lockout expiration of 15 minutes is an effective deterrent against brute forcing that also makes allowances for legitimate mistakes by users.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful login attempts, run the following command:<p></p><p></p>sudo pwpolicy getglobalpolicy | tr ' ' '\n' | grep 'maxFailedLoginAttempts\|minutesUntilFailedLoginReset'<p></p><p></p>If the result is not 'maxFailedLoginAttempts=3' and 'minutesUntilFailedLoginReset=15', and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">Password policy can be set with the pwpolicy utility or with a configuration profile. The variable names may vary depending on how the policy was set. To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful login attempts, run the following command to output the password policy to the screen:<p></p><p></p>sudo pwpolicy getaccountpolicies<p></p><p></p>Look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'. If this does not exist, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>In the array that follows, there should one or more &lt;dict&gt; sections that describe policy checks. One should contain a &lt;string&gt; that allows users to log in if 'policyAttributeFailedAuthentications' is less than 'policyAttributeMaximumFailedAuthentications'. Under policyParameters, policyAttributeMaximumFailedAuthentications should be set to 3. If 'policyAttributeMaximumFailedAuthentications' is not set to 3, this is a finding.<p></p><p></p>In the same check or in another &lt;dict&gt; section, there should be a &lt;string&gt; that allows users to log in if the 'policyAttributeCurrentTime' is greater than the result of adding 15 minutes (900 seconds) to 'policyAttributeLastFailedAuthenticationTime'. The check might use a variable defined in its policyParameters section. If the check does not exist or if the check adds too great an amount of time, this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command:<p></p><p></p>sudo pwpolicy setglobalpolicy 'maxFailedLoginAttempts=3 minutesUntilFailedLoginReset=15'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">This setting may be enforced using a configuration profile.<p></p><p></p>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p></p><p></p>sudo pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the generated file in a text editor and ensure it contains the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag. Replace &lt;dict/&gt; first with &lt;dict&gt;&lt;/dict&gt; if necessary.<p></p><p></p>        &lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;(policyAttributeFailedAuthentications &amp;lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &amp;gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Authentication Lockout&lt;/string&gt;<p></p>                        &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                        &lt;dict&gt;<p></p>                                &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p></p>                                &lt;integer&gt;900&lt;/integer&gt;<p></p>                                &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p></p>                                &lt;integer&gt;3&lt;/integer&gt;<p></p>                        &lt;/dict&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p><p></p>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;(policyAttributeFailedAuthentications &amp;lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &amp;gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Authentication Lockout&lt;/string&gt;<p></p>                &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p></p>                        &lt;integer&gt;900&lt;/integer&gt;<p></p>                        &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p></p>                        &lt;integer&gt;3&lt;/integer&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>AC-7 a</td>
</tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit Account Creation</td>
<td>Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to create a new account. Auditing of account creation mitigates this risk.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>The account creation events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (4)</td>
</tr>
<tr>
<td>Audit Account Creation, Modification, and Deletion</td>
<td>Account creations and account modfications, such as disablement and termination, can all be signs of an intrusion and should be audited. Once an attacker establishes access to a system, the attacker may attempt to create an account to reestablish access at a later time. The attacker may also attempt to modify accounts in an attempt to change an existing account's privileges or disable or delete accounts in a denial-of-service attack. Auditing of account creation, modification, disabling, and termination events mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Privileged access, including the creation, modification, and deletion of local user accounts, is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr>
<td>Audit All Logon Events</td>
<td>Remote access services, such as those providing remote access to network devices and information systems, increase risk and expose those systems to possible cyber attacks, so all remote access should be closely monitored and audited. Only authorized users should be permitted to remotely access DoD non-public information systems. An attacker might attempt to log in as an authorized user, through stolen credentials, unpatched exploits of the remote access service, or brute force attempts to guess a valid username and password. If a user is attempting to log in to a system from an unusual location or at an unusual time, or if there are many failed attempts, there is a possibility that the system is the target of a cyber attack. Auditing logon events mitigates this risk by recording all logon attempts, successful and unsuccessful, to the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check to make sure the audit daemon is configured to log all login events, both local and remote, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>The flag 'lo' should be included in the list of flags set. If it is not, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-17 (1)</td>
</tr>
<tr>
<td>Audit Kernel Module Loading and Unloading</td>
<td>Kernel modules, called kernel extensions in Mac OS X, are compiled segments of code that are dynamically loaded into the kernel as required to support specific pieces of hardware or functionality. Privileged users are permitted to load or unload kernel extensions manually. An attacker might attempt to load a kernel extension that is known to be insecure to increase the attack surface of the system, or a user might plug in an unauthorized device that then triggers a kernel extension to be loaded. Auditing administrative actions, which include the loading or unloading of kernel extensions, mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Privileged access, including administrative use of the command line tools kextload and kextunload, is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit Privileged Access</td>
<td>Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse, and identify the risk from insider threats and the advanced persistent threat.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Privileged access is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-6 (9)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit Access Control Enforcement</td>
<td>By auditing access restriction enforcement, changes to application and OS configuration files can be audited. Without auditing the enforcement of access restrictions, it will be difficult to identify attempted attacks and an audit trail will not be available for forensic investigation.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Enforcement actions are logged by way of the 'fm' flag, which audits permission changes, and '-fr' and '-fw', which denote failed attempts to read or write to a file. If 'fm', '-fr', and '-fw' are not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command to add 'fm', '-fr', and '-fw' at the same time:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,fm,-fr,-fw/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-5 (1)</td>
</tr>
<tr>
<td>Audit Privileged Access</td>
<td>If events associated with non-local administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>This requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Non-local maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>This requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing "ping," "ls," "ipconfig," or the hardware and software implementing the monitoring port of an Ethernet switch.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Administrative actions and changes to configuration settings are logged by way of the 'ad' flag. If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>MA-4 (1) (a)</td>
</tr>
<tr>
<td>Audit Privileged Access</td>
<td>Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse, and identify the risk from insider threats and the advanced persistent threat.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Privileged activities are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Change to Another User</td>
<td>Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privilegs in order to proceed. Auditing successful and unsuccessful attempts to switch to another user account mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Attempts to log in as another user are logged by way of the 'lo' flag. If 'lo' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Change File Permissions</td>
<td>The permissions on a file establish which users are permitted to access or modify it. An attacker may attempt to change the permissions on a file to prevent legitimate users from accessing it or to grant additional access to an account the attacker controls. Auditing successful and unsuccessful attempts to modify security objects such as file permissions mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Change File Permissions</td>
<td>The permissions on a file establish which users are permitted to access or modify it. An attacker may attempt to change the permissions on a file to prevent legitimate users from accessing it or to grant additional access to an account the attacker controls. Auditing successful and unsuccessful attempts to modify security objects such as file permissions mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td></td>
<td>Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the password policy is configured to require that at least one numeric character be used, run the following command:<p></p><p></p>sudo pwpolicy getglobalpolicy | tr ' ' '\n' | grep requiresNumeric<p></p><p></p>If the result is not 'requiresNumeric=1', and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the global password policy is configured to require that at least one numeric character be used, run the following commands:<p></p><p></p>sudo pwpolicy getaccountpolicies<p></p><p></p>Look for the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;. If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that 'matches' the variable 'policyAttributePassword' to the regular expression '(.*[0-9].*){1,}+' or to a similar expression that will ensure the password contains a character in the range 0-9 one or more times. If this check allows users to create passwords without at least one numeric character, or if no such check exists, this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command:<p></p><p></p>sudo pwpolicy setglobalpolicy 'requiresNumeric=1'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command to create a pwpolicy account policy file:<p></p><p></p>sudo pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the generated file in a text editor. If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;. Then, insert the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag. The same text can also be used if the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; is not present.<p></p><p></p>        &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;policyAttributePassword matches '(.*[0-9].*){1,}+'&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;com.apple.policy.legacy.requiresNumeric&lt;/string&gt;<p></p>                        &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                        &lt;dict&gt;<p></p>                                &lt;key&gt;minimumNumericCharacters&lt;/key&gt;<p></p>                                &lt;integer&gt;1&lt;/integer&gt;<p></p>                        &lt;/dict&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p><p></p>If the file does contain policy settings, and the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; does exist, insert the following text after the opening &lt;array&gt; tag that comes right after it:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;policyAttributePassword matches '(.*[0-9].*){1,}+'&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;com.apple.policy.legacy.requiresNumeric&lt;/string&gt;<p></p>                &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;minimumNumericCharacters&lt;/key&gt;<p></p>                        &lt;integer&gt;1&lt;/integer&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>IA-5 (1) (a)</td>
</tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Change File Permissions</td>
<td>The permissions on a file establish which users are permitted to access or modify it. An attacker may attempt to change the permissions on a file to prevent legitimate users from accessing it or to grant additional access to an account the attacker controls. Auditing successful and unsuccessful attempts to modify security objects such as file permissions mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr>
<td>Require Users to Change Their Password Every 60 Days</td>
<td>Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>One method of minimizing this risk is to use complex passwords and periodically change them. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the password policy is configured to require that users change their password every 60 days, run the following command:<p></p><p></p>sudo pwpolicy getglobalpolicy | tr ' ' '\n' | grep maxMinutesUntilChangePassword<p></p><p></p>If the result is not 'maxMinutesUntilChangePassword=86400', and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the global password policy is configured to require users to change their passwords every 60 days, run the following commands:<p></p><p></p>sudo pwpolicy getaccountpolicies<p></p><p></p>Look for the line &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;. If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that compares the variable 'policyAttributeLastPasswordChangeTime' to the variable 'policyAttributeCurrentTime'. It may contain additional variables defined in the policyParameters section that follows it. All comparisons are done in seconds. If this check allows users to log in with passwords older than 60 days, or if no such check exists, this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command:<p></p><p></p>sudo pwpolicy setglobalpolicy 'maxMinutesUntilChangePassword=86400'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command to create a pwpolicy account policy file:<p></p><p></p>sudo pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the generated file in a text editor. If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;. If there already is a policy block that refers to password expiration, ensure it is set to 60 days. If the line '&lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;' is not present in the file, add the following text immediately after the opening &lt;dict&gt; tag in the file:<p></p><p></p>        &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;policyAttributeCurrentTime &amp;gt; policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Password Change Interval&lt;/string&gt;<p></p>                        &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                        &lt;dict&gt;<p></p>                                &lt;key&gt;policyAttributeExpiresEveryNDays&lt;/key&gt;<p></p>                                &lt;integer&gt;60&lt;/integer&gt;<p></p>                        &lt;/dict&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p><p></p>If the line &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt; is already present in the file, the following text should be added just after the opening &lt;array&gt; tag that follows the line instead:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;policyAttributeCurrentTime &amp;gt; policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Password Change Interval&lt;/string&gt;<p></p>                &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyAttributeExpiresEveryNDays&lt;/key&gt;<p></p>                        &lt;integer&gt;60&lt;/integer&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>IA-5 (1) (d)</td>
</tr>
<tr>
<td>Prevent Users From Reusing the Five Previously Used Passwords</td>
<td>Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the password policy is configured to prevent users from reusing one of their five previously used passwords, run the following command:<p></p><p></p>sudo pwpolicy getglobalpolicy | tr ' ' '\n' | grep usingHistory<p></p><p></p>If the result is not 'usingHistory=5', and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the global password policy is configured to require users to change their passwords every 60 days, run the following commands:<p></p><p></p>sudo pwpolicy getaccountpolicies<p></p><p></p>Look for the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;. If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; such as '&lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;'. This searches for the hash of the user-entered password in the list of previous password hashes. In the policyParameters section that follows it, policyAttributePasswordHistoryDepth must be set to 5 or greater. If this parameter is not set to 5 or greater, or if no such check exists, this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command:<p></p><p></p>sudo pwpolicy setglobalpolicy 'usingHistory=5'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command to create a pwpolicy account policy file:<p></p><p></p>sudo pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the generated file in a text editor. If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;. If there already is a policy block that refers to password history, ensure it is set to 5. If the line '&lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;' is not present in the file, add the following text immediately after the opening &lt;dict&gt; tag in the file:<p></p><p></p>        &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Password History&lt;/string&gt;<p></p>                        &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                        &lt;dict&gt;<p></p>                                &lt;key&gt;policyAttributePasswordHistoryDepth&lt;/key&gt;<p></p>                                &lt;integer&gt;5&lt;/integer&gt;<p></p>                        &lt;/dict&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p><p></p>If the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; is already present in the file, the following text should be added just after the opening &lt;array&gt; tag that follows the line instead:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Password History&lt;/string&gt;<p></p>                &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyAttributePasswordHistoryDepth&lt;/key&gt;<p></p>                        &lt;integer&gt;5&lt;/integer&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>IA-5 (1) (e)</td>
</tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Change File Permissions</td>
<td>The permissions on a file establish which users and groups are permitted to access or modify it. An attacker may attempt to change the permissions on a file to prevent legitimate users from accessing it or to grant additional access to an account the attacker controls. Auditing successful and unsuccessful attempts to modify security objects such as file permissions mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit Successful and Unsuccessful Attempts to Gain Privileged Access</td>
<td>Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing successful and unsuccessful attempts to elevate privileges mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The options to configure the audit daemon are located in the /etc/security/audit_control file. To view the current settings, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>If the 'lo', 'ad', and 'aa' options are not set, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the audit flags to the recommended setting, run the following command to add the flags 'lo', 'ad', and 'aa' all at once:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,lo,ad,aa/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr>
<td>Audit Successful and Unsuccessful File Accesses, File Modifications, Logon Attempts, User Account Modifications, Privileged Elevation, and Kernel Module Loading and Unloading</td>
<td>Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. DoD has defined the list of events for which the operating system will provide an audit record generation capability as the following: <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system;<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(iii) All account creations, modifications, disabling, and terminations; and <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(iv) All kernel module load, unload, and restart actions.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The options to configure the audit daemon are located in the /etc/security/audit_control file.  To view the current settings, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control | sed 's/flags://'<p></p><p></p>If the 'lo', 'ad', and 'aa' options are not set, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the audit flags to the recommended setting, run the following command to add the flags 'lo', 'ad', and 'aa' all at once:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,lo,ad,aa/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 a</td>
</tr>
<tr>
<td>Audit Successful and Unsuccessful Logon Attempts</td>
<td>An attacker might attempt to log in as an authorized user, through stolen credentials, unpatched exploits, or brute force attempts to guess a valid username and password. If a user is attempting to log in to a system at an unusual time, or if there are many failed attempts, there is a possibility that the system is the target of an attack. Auditing logon events mitigates this risk by recording all logon attempts, successful and unsuccessful, to the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>Logon events are logged by way of the 'aa' flag.  If 'aa' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-12 c</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Audit User Account Creation</td>
<td>Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to create a new account or modify an existing one. Auditing of account creation and modification is one method for mitigating this risk.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>The account creation events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (4)</td>
</tr>
<tr>
<td>Audit User Account Deletion</td>
<td>When operating system accounts are removed, user accessibility is affected. The system must audit account removal actions so that administrator users can detect and respond to such events. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and provides logging that can be used for forensic purposes. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>The account modification events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (4)</td>
</tr>
<tr>
<td>Audit User Account Disablement</td>
<td>When operating system accounts are disabled, user accessibility is affected. The system must audit account disablement actions so that administator users can detect and respond to such events. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and provides logging that can be used for forensic purposes. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">In order to view the currently configured flags for the audit daemon, run the following command:<p></p><p></p>sudo grep ^flags /etc/security/audit_control<p></p><p></p>The account modification events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make sure the appropriate flags are enabled for auditing, run the following command:<p></p><p></p>sudo sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; sudo audit -s<p></p><p></p>You may also edit the /etc/security/audit_control file using a text editor to define the flags your organization requires for auditing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (4)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Install and Configure an Approved Tool for Continuous Scanning</td>
<td>An approved tool for continuous network scanning must be installed and configured to run.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Without the use of automated mechanisms to scan for security flaws on a continuous and/or periodic basis, the operating system or other system components may remain vulnerable to the exploits presented by undetected software flaws.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To support this requirement, the operating system may have an integrated solution incorporating continuous scanning using HBSS and periodic scanning using other tools, as specified in the requirement.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Ask the SA or IAO if an approved tool capable of continuous scanning is loaded on the system. The recommended system is the McAfee HBSS. If no such tool is installed on the system, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Install an approved HBSS or firewall solution onto the system.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>SI-2 (2)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Configure sudo to Prompt for a Password at Least Once in Each Terminal Window</td>
<td>The sudo command must be configured to prompt for the administrator user's password at least once in each newly opened Terminal window or remote login session, as this prevents a malicious user from taking advantage of an unlocked computer or an abandoned login session to bypass the normal password prompt requirement. Without the tty_tickets option, all open local and remote login sessions would be authenticated to use sudo without a password for the duration of the configured password timeout window.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the tty_tickets option is set for sudo, run the following command:<p></p><p></p>sudo grep tty_tickets /etc/sudoers<p></p><p></p>If there is no result, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Edit the /etc/sudoers file to contain the line:<p></p><p></p>Defaults tty_tickets</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Disable Automatic Actions for Blank CDs</td>
<td>Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for blank CDs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting for blank CDs in the configuration profile, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep 'com.apple.digihub.blank.cd.appeared' | grep 'action' | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>The check should return a value of '1'. If this is not defined or not set to '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable Automatic Actions for Blank DVDs</td>
<td>Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for blank DVDs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting for blank DVDs in the configuration profile, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep 'com.apple.digihub.blank.dvd.appeared' | grep 'action' | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>The check should return a value of '1'. If this is not defined or not set to '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Automatic Actions for Music CDs</td>
<td>Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for music CDs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting for music CDs open up System Preferences, CDs &amp; DVDs. The setting for 'When you insert a music CD' should be set to 'Ignore', if it is not, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open up System Preferences, CDs &amp; DVDs.  Change the setting for 'When you insert a music CD'  to 'Ignore'.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Disable Automatic Actions for Picture CDs</td>
<td>Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for picture CDs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting for picture CDs open up System Preferences, CDs &amp; DVDs. The setting for 'When you insert a picture CD' should be set to 'Ignore', if it is not, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open up System Preferences, CDs &amp; DVDs.  Change the setting for 'When you insert a picture CD'  to 'Ignore'.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Automatic Actions for Video DVDs</td>
<td>Applications should not be configured to launch automatically when a disk is inserted. This potentially circumvents anti virus software and allows malicious users to craft disks that can exploit user applications. Disabling Automatic Actions for video DVDs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting for picture CDs open up System Preferences, CDs &amp; DVDs. The setting for 'When you insert a video DVD' should be set to 'Ignore', if it is not, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open up System Preferences, CDs &amp; DVDs.  Change the setting for 'When you insert a video DVD'  to 'Ignore'.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Automatic Logons</td>
<td>When automatic logins are enabled, the default user account is automatically logged in at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer in order to log in. Disabling automatic logins mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system if configured to automatically log in, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep DisableAutoLoginClient | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Bluetooth</td>
<td>The Bluetooth kernel extension must be removed, as wireless access introduces unnecessary security risks. Removing Bluetooth support entirely mitigates this risk and ensures the operating system enforces this requirement.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if there are any hardware components for Bluetooth loaded in the system, run the following command:<p></p><p></p>sudo kextstat | grep -i bluetooth<p></p><p></p>If there is a result, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Removing the kernel extensions for Bluetooth will remove the system's ability to load Bluetooth devices, use the following commands to remove them:<p></p><p></p>sudo rm -rf /System/Library/Extensions/IOBluetoothFamily.kext /System/Library/Extensions/IOBluetoothHIDDDriver.kext; sudo touch /System/Library/Extensions</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>low</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Bluetooth Sharing</td>
<td>Bluetooth sharing allows users to wirelessly transmit files between Mac OS X and Bluetooth-enabled devices, including personally owned cell phones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files. Disabling Bluetooth Sharing mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if Bluetooth Sharing is enabled, Open up System Preferences-&gt;Sharing and verify that 'Bluetooth Sharing' is not checked 'ON'. If it is 'ON', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable Bluetooth Sharing, open System Preferences-&gt;Sharing and uncheck the box next to Bluetooth Sharing.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Expired User Accounts</td>
<td>If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Temporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>If temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems may be integrated with enterprise level authentication/access mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">If a temporary user has been created on the workstation, you can check the expiration settings using the following command:<p></p><p></p>sudo pwpolicy -u username get-effective-policy | tr ' ' '\n' | grep 'usingHardExpirationDate\|hardExpireDateGMT'<p></p><p></p>The value of 'usingHardExpirationDate' should be '1', and the value for the 'hardExpireDateGMT' should be a valid date.  If they are not set correctly, and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">Password policy can be set with the pwpolicy utility. The variable names may vary depending on how the policy was set. To check if the password policy is configured to disable a temporary account after 72 hours, run the following command to output the password policy to the screen:<p></p><p></p>sudo pwpolicy -u username getaccountpolicies | tail -n +2<p></p><p></p>If there is no output, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>Otherwise, look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'. In the array that follows, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that allows users to log in if 'policyAttributeCurrentTime' is less than the result of adding 'policyAttributeCreationTime' to 72hours (259299 seconds). The check might use a variable defined in its policyParameters section. If the check does not exist or if the check adds too great an amount of time to 'policyAttributeCreationTime', this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set an expiration date for a temporary account, use the following command:<p></p><p></p>sudo pwpolicy -u username setpolicy 'usingHardExpirationDate=1 hardExpireDateGMT=mm/dd/yy'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">This setting may be enforced using a configuration profile or by a directory server.<p></p><p></p>To set the password policy without a configuration profile, run the following command to save a copy of the current policy file for the specified username:<p></p><p></p>sudo pwpolicy -u username getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the resulting password policy file in a text editor. If other policy settings are present, and the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, insert the following text after the &lt;array&gt; tag that immediately follows it:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;policyAttributeCurrentTime &amp;lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Disable Temporary Account&lt;/string&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>At a minimum, edit the file to ensure that it contains the following text:<p></p><p></p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<p></p>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<p></p>&lt;plist version="1.0"&gt;<p></p>&lt;dict&gt;<p></p>        &lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;policyAttributeCurrentTime &amp;lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Disable Temporary Account&lt;/string&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p>&lt;/dict&gt;<p></p>&lt;/plist&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy -u username setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (2)</td>
</tr>
<tr>
<td>Disable Infrared [IR]</td>
<td>Infrared [IR] kernel support must be disabled to prevent users from controlling the system with IR devices. By default, if IR is enabled, the system will accept IR control from any remote.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if IR support is disabled, run the following command:<p></p><p></p>sudo defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled<p></p><p></p>If the result is not '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable IR, run the following command:<p></p><p></p>sudo defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -bool FALSE</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable IPv4 Forwarding</td>
<td>IP forwarding for IPv4 must not be enabled, unless the system is a router, as only authorized systems should be permitted to operate as routers.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if IP forwarding is enabled, run the following command:<p></p><p></p>sysctl net.inet.ip.forwarding net.inet6.ip6.forwarding<p></p><p></p>If the values are not '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To configure the system to disable IP forwarding, add the following lines to /etc/sysctl.conf:<p></p><p></p>net.inet.ip.forwarding=0<p></p>net.inet6.ip6.forwarding=0</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Enable the Audit Service</td>
<td>If auditing is enabled late in the startup process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the audit service is running, use the following command:<p></p><p></p>sudo launchctl list | grep com.apple.auditd<p></p><p></p>If nothing is returned, the audit service is not running and this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To enable the audit service, run the following command:<p></p><p></p>sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-14 (1)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable IPv6 if Not in Use</td>
<td>Security appliances and firewalls are not always IPv6 aware, meaning that IPv6 traffic is frequently unfiltered and unprotected. If it is not in use, it should be disabled.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Run the following command to check if IPv6 is enabled on any network interfaces:<p></p><p></p>sudo networksetup -listallnetworkservices | (while read dev; do echo "$dev"; networksetup -getinfo "$dev" | grep IPv6:; echo ; done)<p></p><p></p>If there is an enabled network interface without the setting 'IPv6: Off' and it does not require IPv6, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Run the following command to turn off IPv6 addressing for the Ethernet interface:<p></p><p></p>sudo networksetup -setv6off 'Ethernet'<p></p><p></p>Repeat this command for each enabled interface, interface names are case sensitive.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Disable iTunes Music Sharing</td>
<td>When iTunes Music Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet. Unnecessary network services should always be disabled because they increase the attack surface of the system. Disabling iTunes Music Sharing mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the iTunes music sharing is disabled, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep disableSharedMusic | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the value returned is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>low</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Lock User Accounts after Three Failed Login Attempts</td>
<td>By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account. Setting a lockout expiration of 15 minutes is an effective deterrent against brute forcing that also makes allowances for legitimate mistakes by users.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful login attempts, run the following command:<p></p><p></p>sudo pwpolicy getglobalpolicy | tr ' ' '\n' | grep 'maxFailedLoginAttempts\|minutesUntilFailedLoginReset'<p></p><p></p>If the result is not 'maxFailedLoginAttempts=3' and 'minutesUntilFailedLoginReset=15', and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">Password policy can be set with the pwpolicy utility or with a configuration profile. The variable names may vary depending on how the policy was set. To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful login attempts, run the following command to output the password policy to the screen:<p></p><p></p>sudo pwpolicy getaccountpolicies<p></p><p></p>Look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'. If this does not exist, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>In the array that follows, there should one or more &lt;dict&gt; sections that describe policy checks. One should contain a &lt;string&gt; that allows users to log in if 'policyAttributeFailedAuthentications' is less than 'policyAttributeMaximumFailedAuthentications'. Under policyParameters, policyAttributeMaximumFailedAuthentications should be set to 3. If 'policyAttributeMaximumFailedAuthentications' is not set to 3, this is a finding.<p></p><p></p>In the same check or in another &lt;dict&gt; section, there should be a &lt;string&gt; that allows users to log in if the 'policyAttributeCurrentTime' is greater than the result of adding 15 minutes (900 seconds) to 'policyAttributeLastFailedAuthenticationTime'. The check might use a variable defined in its policyParameters section. If the check does not exist or if the check adds too great an amount of time, this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the password policy, run the following command:<p></p><p></p>sudo pwpolicy setglobalpolicy 'maxFailedLoginAttempts=3 minutesUntilFailedLoginReset=15'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">This setting may be enforced using a configuration profile.<p></p><p></p>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p></p><p></p>sudo pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the generated file in a text editor and ensure it contains the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag. Replace &lt;dict/&gt; first with &lt;dict&gt;&lt;/dict&gt; if necessary.<p></p><p></p>        &lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;(policyAttributeFailedAuthentications &amp;lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &amp;gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Authentication Lockout&lt;/string&gt;<p></p>                        &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                        &lt;dict&gt;<p></p>                                &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p></p>                                &lt;integer&gt;900&lt;/integer&gt;<p></p>                                &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p></p>                                &lt;integer&gt;3&lt;/integer&gt;<p></p>                        &lt;/dict&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p><p></p>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;(policyAttributeFailedAuthentications &amp;lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &amp;gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Authentication Lockout&lt;/string&gt;<p></p>                &lt;key&gt;policyParameters&lt;/key&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p></p>                        &lt;integer&gt;900&lt;/integer&gt;<p></p>                        &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p></p>                        &lt;integer&gt;3&lt;/integer&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>AC-7 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable Non-essential Services</td>
<td>It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Operating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Examples of non-essential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The 'rshd' service should be disabled. To check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.rshd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.<p></p><p></p>Remote Apple Events must be disabled. To check if Remote Apple Events is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.AEServer:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.<p></p><p></p>The system preference panel iCloud must be removed or disabled along with the Internet Accounts preference pane in a configuration profile. To check for the existence of the iCloud preference panel, run the following command:<p></p><p></p>ls -ld /System/Library/PreferencePanes/iCloudPref.prefPane<p></p><p></p>If anything is returned, and access to the iCloud and Internet Accounts preference panes have not been disabled with a configuration profile, this is a finding.<p></p><p></p>The system must not have the UUCP service active. To check if UUCP is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.uucp:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable the 'rshd' service, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.rshd' -dict Disabled -bool true<p></p><p></p>To disable Remote Apple Events, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.AEServer' -dict Disabled -bool true<p></p><p></p>Either disable access to the iCloud and Internet Accounts preference panes through a configuration profile or run the following command to remove the iCloud panel:<p></p><p></p>sudo rm -rf /System/Library/PreferencePanes/iCloudPref.prefPane<p></p><p></p>To disable UUCP, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.uucp' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 a</td>
</tr>
<tr>
<td>Disable NFS Services if Not in Use</td>
<td>If the system does not require access to NFS (Network File System) file shares or is not acting as an NFS server, then support for NFS is non-essential and NFS services must be disabled. NFS is a network file system protocol supported by Unix-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The NFS daemon must be disabled. To check if NFS is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.nfsd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.<p></p><p></p>The NFS lock daemon must be disabled. To check if the NFS lock daemon is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.lockd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.<p></p><p></p>The NFS stat daemon must be disabled. To check if the NFS stat daemon is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.statd.notify:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable NFS, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.nfsd' -dict Disabled -bool true<p></p><p></p>To disable NFS lockd, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.lockd' -dict Disabled -bool true<p></p><p></p>To disable NFS statd, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.statd.notify' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 a</td>
</tr>
<tr>
<td>Disable Web Sharing Service</td>
<td>Web Sharing is non-essential and must be disabled. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Web Sharing must be disabled. To check if Web Sharing is enabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print org.apache.httpd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable Web Sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'org.apache.httpd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 a</td>
</tr>
<tr>
<td>Disable File Sharing Services</td>
<td>File Sharing is non-essential and must be disabled. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">File Sharing must be disabled.<p></p><p></p>To check if Apple File (AFP) Sharing is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.AppleFileServer:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.<p></p><p></p>To check if SMB File Sharing is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.smbd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable Apple File (AFP) Sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.AppleFileServer' -dict Disabled -bool true<p></p><p></p>To disable SMB File Sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.smbd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 a</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Configure a Network Time Server</td>
<td>Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Organizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The Network Time Protocol (NTP) service must be enabled on all networked systems. To check if the service is running, use the following command:<p></p><p></p>sudo launchctl list | grep org.ntp.ntpd<p></p><p></p>If nothing is returned, this is a finding.<p></p><p></p>To ensure that an authorized NTP server is configured, run the following command or examine /etc/ntp.conf:<p></p><p></p>sudo grep ^server /etc/ntp.conf<p></p><p></p>Only approved time servers should be configured for use. If no server is configured, or if an unapproved time server is in use, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To enable the NTP service, run the following command:<p></p><p></p>sudo launchctl load -w /System/Library/LaunchDaemons/org.ntp.ntpd.plist<p></p><p></p>To configure one or more time servers for use, edit /etc/ntp.conf and enter each hostname or ip address on a separate line, prefixing each one with the keyword "server".</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-8 (1) (a)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable Non-essential Network Functions and Protocols</td>
<td>In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Operating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To support the requirements and principles of least functionality, the operating system must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Sending diagnostic &amp; usage data to Apple must be disabled. The setting is found in System Preferences-&gt;Security &amp; Privacy-&gt;Diagnostics &amp; Usage. If the box that says 'Send diagnostic &amp; usage data to Apple' is checked, this is a finding. To check if a configuration profile is configured to enforce this setting, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep AutoSubmit | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '0' this is a finding.<p></p><p></p><p></p>Find My Mac must be disabled. To check if Find My Mac is disabled on the system, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.findmymacd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Find My Mac messenger must be disabled. To check if Find My Mac messenger is disabled on the system, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.findmymacmessenger:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Location Services must be disabled. The setting is found in System Preferences-&gt;Security &amp; Privacy-&gt;Location Services.  If the box that says 'Enable Location Services' is checked, this is a finding. To check if a configuration profile is configured to enforce this setting, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep DisableLocationServices | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '1' this is a finding.<p></p><p></p><p></p>Internet Sharing must be disabled. To check if Internet sharing is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.InternetSharing:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Bonjour multicast advertising must be disabled on the system. To check if multicast advertisements have been disabled, run the following command:<p></p><p></p>sudo defaults read /System/Library/LaunchDaemons/com.apple.mDNSResponder | grep NoMulticastAdvertisements<p></p><p></p>If nothing is returned, this is a finding.<p></p><p></p><p></p>Airdrop must be disabled. To check if Airdrop has been disabled, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep DisableAirDrop | awk '{ print $3 }' | sed 's/;//'<p></p>If the result is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">Sending diagnostic &amp; usage data to Apple must be disabled. The setting is found in System Preferences-&gt;Security &amp; Privacy-&gt;Diagnostics &amp; Usage. If the box that says 'Send diagnostic &amp; usage data to Apple' is checked, this is a finding. To check if a configuration profile is configured to enforce this setting, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep AutoSubmit | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '0' this is a finding.<p></p><p></p><p></p>Find My Mac must be disabled. To check if Find My Mac is disabled on the system, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.findmymacd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Find My Mac messenger must be disabled. To check if Find My Mac messenger is disabled on the system, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.findmymacmessenger:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Location Services must be disabled. The setting is found in System Preferences-&gt;Security &amp; Privacy-&gt;Location Services.  If the box that says 'Enable Location Services' is checked, this is a finding. To check if a configuration profile is configured to enforce this setting, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep DisableLocationServices | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '1' this is a finding.<p></p><p></p><p></p>Network Sharing must be disabled. To check if Network sharing is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.NetworkSharing:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.<p></p><p></p><p></p>Bonjour multicast advertising must be disabled on the system. To check if multicast advertisements have been disabled, run the following command:<p></p><p></p>sudo defaults read /System/Library/LaunchDaemons/com.apple.discoveryd | grep NoMulticastAdvertisements<p></p><p></p>If nothing is returned, this is a finding.<p></p><p></p><p></p>Airdrop must be disabled. To check if Airdrop has been disabled, run the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep DisableAirDrop | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result is not '1', this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">The setting "Send diagnostic &amp; usage data to Apple" is found in System Preferences-&gt;Security &amp; Privacy-&gt;Diagnostics &amp; Usage. Uncheck the box that says 'Send diagnostic &amp; usage data to Apple. This setting can be enforced using a configuration profile.<p></p><p></p><p></p>To disable Find My Mac, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.findmymacd' -dict Disabled -bool true<p></p><p></p><p></p>To disable Find My Mac messenger, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.findmymacmessenger' -dict Disabled -bool true<p></p><p></p><p></p>The setting "Enable Location Services" is found in System Preferences-&gt;Security &amp; Privacy-&gt;Location Services. Uncheck the box that says 'Enable Location Services'.This setting can be enforced using a configuration profile.<p></p><p></p><p></p>To disable Internet Sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.InternetSharing' -dict Disabled -bool true<p></p><p></p><p></p>To configure Bonjour to disable multicast advertising, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'Add :ProgramArguments:2 string '-NoMulticastAdvertisements'' /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist<p></p><p></p><p></p>Disabling AirDrop is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">The setting "Send diagnostic &amp; usage data to Apple" is found in System Preferences-&gt;Security &amp; Privacy-&gt;Diagnostics &amp; Usage. Uncheck the box that says 'Send diagnostic &amp; usage data to Apple. This setting can be enforced using a configuration profile.<p></p><p></p><p></p>To disable Find My Mac, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.findmymacd' -dict Disabled -bool true<p></p><p></p><p></p>To disable Find My Mac messenger, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.findmymacmessenger' -dict Disabled -bool true<p></p><p></p><p></p>The setting "Enable Location Services" is found in System Preferences-&gt;Security &amp; Privacy-&gt;Location Services. Uncheck the box that says 'Enable Location Services'. This setting can be enforced using a configuration profile.<p></p><p></p><p></p>To disable Network Sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.NetworkSharing' -dict Disabled -bool true<p></p><p></p><p></p>To configure Bonjour to disable multicast advertising, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'Add :ProgramArguments:1 string '--no-multicast'' /System/Library/LaunchDaemons/com.apple.discoveryd.plist<p></p><p></p><p></p>Disabling AirDrop is enforced using a configuration profile.</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable Screen Sharing</td>
<td>The Screen Sharing feature allows remote users to view or control the desktop of the current user. A malicious user can take advantage of Screen Sharing to gain full access to the system remotely, either with stolen credentials or by guessing the username and password. Disabling Screen Sharing mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if screen sharing is disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.screensharing:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable screen sharing, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.screensharing' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable the Finger Service</td>
<td>The finger service has had several security vulnerabilities in the past and is not a necessary service. It is disabled by default; enabling it would increase the attack surface of the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the finger service has been disabled, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.fingerd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To ensure that the finger service is disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.fingerd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable the Insecure SSH Version 1 Protocol</td>
<td>The SSH Version should be explicity set to Version 2. Version 2 supports strong crypto and was rewritten from scratch to resolve several weaknesses in Version 1 that make it extremely vulnerable to attackers. The weaker crypto in Version 1 is potentially susceptible to certain forms of replay attacks. The system default is to only enable Version 2.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>A replay attack may enable an unauthorized user to gain access to the operating system. Authentication sessions between the authenticator and the operating system validating the user credentials must not be vulnerable to a replay attack. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check which protocol is configured for sshd, run the following:<p></p><p></p>sudo grep ^Protocol /etc/sshd_config<p></p><p></p>If there is no result or the result is not '2', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">In order to make sure that 'Protocol 2' is used by sshd, run the following command:<p></p><p></p>sudo sed -i.bak 's/.*Protocol.*/Protocol 2/' /etc/sshd_config</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>IA-2 (8)</td>
</tr>
<tr>
<td>Disable the Insecure SSH Version 1 Protocol</td>
<td>The SSH Version should be explicity set to Version 2. Version 2 supports strong crypto and was rewritten from scratch to resolve several weaknesses in Version 1 that make it extremely vulnerable to attackers. The weaker crypto in Version 1 is potentially susceptible to certain forms of replay attacks. The system default is to only enable Version 2.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>A replay attack may enable an unauthorized user to gain access to the operating system. Authentication sessions between the authenticator and the operating system validating the user credentials must not be vulnerable to a replay attack. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check which protocol is configured for sshd, run the following:<p></p><p></p>sudo grep ^Protocol /etc/sshd_config<p></p><p></p>If there is no result or the result is not '2', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">In order to make sure that 'Protocol 2' is used by sshd, run the following command:<p></p><p></p>sudo sed -i.bak 's/.*Protocol.*/Protocol 2/' /etc/sshd_config</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>IA-2 (9)</td>
</tr>
<tr></tr>
<tr>
<td>Disable the Prompt for Apple ID and iCloud</td>
<td>The prompt for Apple ID and iCloud must be disabled, as it might mislead new users into creating unwanted Apple IDs and iCloud storage accounts upon their first login.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the prompt for Apple ID and iCloud are disabled for new users, run the following command:<p></p><p></p>sudo defaults read /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant<p></p><p></p>If there is no result, or the results do not include 'DidSeeCloudSetup = 1 AND LastSeenCloudProductVersion = 10.9', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the prompt for Apple ID and iCloud are disabled for new users, run the following command:<p></p><p></p>sudo defaults read /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant<p></p><p></p>If there is no result, or the results do not include 'DidSeeCloudSetup = 1 AND LastSeenCloudProductVersion = 10.10', this is a finding.</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To ensure that the prompt for Apple ID and iCloud is disabled, run the following commands:<p></p><p></p>sudo defaults write  /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant DidSeeCloudSetup -bool TRUE; sudo defaults write  /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant LastSeenCloudProductVersion '10.9'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">To ensure that the prompt for Apple ID and iCloud is disabled, run the following commands:<p></p><p></p>sudo defaults write  /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant DidSeeCloudSetup -bool TRUE; sudo defaults write  /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant LastSeenCloudProductVersion '10.10'</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable the Telnet Service</td>
<td>The telnet service must be disabled, as it sends all data, including the user's password in a clear text form that can be easily intercepted and read. Passwords need to be protected at all times and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'telnet' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.telnetd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the telnet service to disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.telnetd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>IA-5 (1) (c)</td>
</tr>
<tr>
<td>Disable the Telnet Service</td>
<td>The telnet service must be disabled, as it sends all data, including the user's password, in a clear text form that can be easily intercepted and read. Passwords need to be protected at all times and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk. Administrators should be instructed to use an alternate service for remote access sessions that uses encryption, such as SSH.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'telnet' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.telnetd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the 'telnet' service to disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.telnetd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>MA-4 c</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable the Telnet Service</td>
<td>The telnet service must be disabled, as it sends all data, including the user's password, in a clear text form that can be easily intercepted and read. Passwords need to be protected at all times and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk. Authorized users should be instructed to use an alternate service that implements cryptography for remote access sessions, such as SSH.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'telnet' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.telnetd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the telnet service to disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.telnetd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-17 (2)</td>
</tr>
<tr>
<td>Disable the Telnet Service</td>
<td>The telnet service must be disabled, as it sends all data, including the user's password, in a clear text form that can be easily intercepted and read. Passwords need to be protected at all times and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk. Administrator users should be instructed to use an alternate service that implements cryptography such as SSH.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'telnet' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.telnetd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the 'telnet' service to disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.telnetd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>MA-4 (6)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable the Telnet Service</td>
<td>The telnet service must be disabled, as it sends all data, including the user's password, in a clear text form that can be easily intercepted and read. Passwords need to be protected at all times and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Disabling telnet is one way to mitigate this risk. Administrator users should be instructed to use an alternate service that implements cryptography such as SSH.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'telnet' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.telnetd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the 'telnet' service to disabled, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.telnetd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>MA-4 (6)</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Disable Unencrypted Remote Execute Service</td>
<td>The rexec service must be disabled. The rexec service does not implement crypto and has had several security vulnerabilities in the past. It is disabled by default; enabling it would increase the attack surface of the system.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Remote access is access to DoD non-public information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p> <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Encryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection (e.g., RDP) thereby providing a degree of confidentiality. The encryption strength of mechanism is selected based on the security categorization of the information.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The service 'rexec' should be disabled, to check the status of the service, run the following command:<p></p><p></p>sudo /usr/libexec/PlistBuddy -c 'print com.apple.rexecd:Disabled' /var/db/launchd.db/com.apple.launchd/overrides.plist<p></p><p></p>If the returned value isn't 'true' or doesn't exist, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable the 'rexec' service, run the following command:<p></p><p></p>sudo defaults write /private/var/db/launchd.db/com.apple.launchd/overrides.plist 'com.apple.rexecd' -dict Disabled -bool true</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-17 (2)</td>
</tr>
<tr>
<td>Disable Unused Network Devices</td>
<td>If an unused network device is left enabled, a user might be able to activate it at a later time. Unused network devices should be disabled.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To list the network devices that are enabled on the system, run the following command:<p></p><p></p>sudo networksetup -listallnetworkservices<p></p><p></p>A disabled device will have an asterisk in front of its name. If any listed device that is not in use is missing this asterisk, it must be disabled.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable a network device, run the following command, substituting the name of the device in place of &lt;networkservice&gt;:<p></p><p></p>sudo networksetup -setnetworkserviceenabled '&lt;networkservice&gt;' off</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Disable Wi-Fi if Not Required</td>
<td>The kernel extension for Wi-Fi network devices such as Airport must be removed to ensure that users will not be able to reactivate wireless networking at a later time. System updates will sometimes replace deleted kernel extensions. Administrator users may need to periodically check to ensure that the file remains deleted. Alternately, the wireless card hardware may be removed from the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the Wi-Fi network device is disabled, run the following command:<p></p><p></p>sudo networksetup -listallnetworkservices<p></p><p></p>A disabled device will have an asterisk in front of its name. If the Wi-Fi device is missing this asterisk, it must be disabled.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable the Wi-Fi network device, run the following command:<p></p><p></p>sudo networksetup -setnetworkserviceenabled 'Wi-Fi' off</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Display the Mandatory DoD Notice and Consent Banner to Users at Logon</td>
<td>Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for operating system that can accommodate banners of 1300 characters:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-At any time, the USG may inspect and seize data stored on this IS.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p> <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>"I've read &amp; consent to terms in IS user agreem't."</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The policy banner will show if a PolicyBanner.rtf or PolicyBanner.rtfd exists in the /Library/Security folder. Run this command to show the contents of that folder:<p></p><p></p>ls -l /Library/Security/PolicyBanner.rtf*<p></p><p></p>If neither PolicyBanner.rtf nor PolicyBanner.rtfd exists, this is a finding.<p></p><p></p>For systems that allow remote access through SSH, run the following command to ensure that /etc/motd exists:<p></p><p></p>ls -l /etc/motd<p></p><p></p>If /etc/motd does not exist, this is a finding.<p></p><p></p>The banner text of each document MUST read:<p></p><p></p>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p></p>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p></p>-At any time, the USG may inspect and seize data stored on this IS.<p></p>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<p></p>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p></p>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<p></p><p></p>If the text is not worded exactly this way, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Create a RTF formatted file containing the required text. Name the file PolicyBanner.rtf or PolicyBanner.rtfd and place it in /Library/Security/<p></p><p></p>For systems that allow remote access through SSH, create a plain text file containing the required text and save it as /etc/motd.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-8 a</td>
</tr>
<tr>
<td>Display the Mandatory DoD Notice and Consent Banner to Users at Logon</td>
<td>Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for operating system that can accommodate banners of 1300 characters:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-At any time, the USG may inspect and seize data stored on this IS.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p> <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>"I've read &amp; consent to terms in IS user agreem't."</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The policy banner will show if a PolicyBanner.rtf or PolicyBanner.rtfd exists in the /Library/Security folder. Run this command to show the contents of that folder:<p></p><p></p>ls -l /Library/Security/PolicyBanner.rtf*<p></p><p></p>If neither PolicyBanner.rtf nor PolicyBanner.rtfd exists, this is a finding. <p></p><p></p>For systems that allow remote access through SSH, run the following command to ensure that /etc/motd exists:<p></p><p></p>ls -l /etc/motd<p></p><p></p>If /etc/motd does not exist, this is a finding.<p></p><p></p>The banner text of each document MUST read:<p></p><p></p>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p></p>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p></p>-At any time, the USG may inspect and seize data stored on this IS.<p></p>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<p></p>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p></p>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants.  Such communications and work product are private and confidential. See User Agreement for details."<p></p><p></p>If the text is not worded exactly this way, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Create a RTF formatted file containing the required text.  Name the file PolicyBanner.rtf or PolicyBanner.rtfd and place it in /Library/Security/<p></p><p></p>For systems that allow remote access through SSH, create a plain text file containing the required text and save it as /etc/motd.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-8 c 1, AC-8 c 2, AC-8 c 3</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Don't Send ICMPv4 Redirect Messages</td>
<td>ICMP redirects are broadcast in order to reshape network traffic. A malicious user could use the system to send fake redirect packets and try to force all network traffic to pass through a network sniffer. Disabling ICMP redirect broadcasts mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is configured to send ICMP redirects, run the following command:<p></p><p></p>sysctl net.inet.ip.redirect net.inet6.ip6.redirect<p></p><p></p>If the values are not set to '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To configure the system to not send ICMP redirects, add the following lines to /etc/sysctl.conf:<p></p><p></p>net.inet.ip.redirect=0<p></p>net.inet6.ip6.redirect=0</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Don't Forward Source-Routed Packets</td>
<td>A source-routed packet attempts to specify the network path that the system should take. If the system is not configured to block the sending of source-routed packets, an attacker can redirect the system's network traffic.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is configured to forward source-routed packets, run the following command:<p></p><p></p>sysctl net.inet.ip.sourceroute<p></p><p></p>If the value is not set to '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To configure the system to not forward source-routed packets, add the following line to /etc/sysctl.conf:<p></p><p></p>net.inet.ip.sourceroute=0</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr></tr>
<tr>
<td>Drop Incoming ICMPv4 Redirect Messages</td>
<td>ICMP redirects are broadcast in order to reshape network traffic. A malicious user could craft fake redirect packets and try to force all network traffic to pass through a network sniffer. If the system is not configured to ignore these packets, it could be suspectible to this kind of attack.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is configured to ignore ICMP redirect messages, run the following command:<p></p><p></p>sysctl net.inet.icmp.drop_redirect<p></p><p></p>If the value is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To configure the system to ignore ICMP redirect messages, add the following line to /etc/sysctl.conf:<p></p><p></p>net.inet.icmp.drop_redirect=1</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Drop Incoming ICMPv4 Timestamp Requests</td>
<td>ICMP Timestamp requests reveal information about the system and can be used to determine which operating system is installed. Precise time data can also be used to launch time based attacks against the system. Configuring the system to drop incoming ICMPv4 timestamp requests mitigates these risks.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is configured to process ICMP timestamp requests, run the following command:<p></p><p></p>sysctl net.inet.icmp.timestamp<p></p><p></p>If the value is not set to '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To disable ICMP timestamp responses, add the following line to /etc/sysctl.conf:<p></p><p></p>net.inet.icmp.timestamp=0</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr></tr>
<tr>
<td>Drop Incoming Source-Routed Packets</td>
<td>A source-routed packet attempts to specify the network path the packet should take. If the system is not configured to block the incoming source-routed packets, an attacker can redirect the system's network traffic. Configuring the system to drop incoming source-routed IPv4 packets mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is configured to accept source-routed packets, run the following command:<p></p><p></p>sysctl net.inet.ip.accept_sourceroute<p></p><p></p>If the value is not '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To configure the system to not accept source-routed packets, add the following line to /etc/sysctl.conf:<p></p><p></p>net.inet.ip.accept_sourceroute=0</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Enable a Rule-Based Approved Firewall</td>
<td>An approved firewall must be installed and enabled. When configured correctly, firewalls protect computers from network attacks by blocking or limiting access to open network ports.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The system firewall must be configured with a default-deny policy. Ask the SA or IAO if an approved firewall is loaded on the system.  The recommended system is the McAfee HBSS. If there is no local firewall installed on the system, and configured with a default deny policy, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Install an approved HBSS or firewall solution onto the system and configure it with a default-deny policy.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-4</td>
</tr>
<tr>
<td>Enable Application Firewall</td>
<td>The Application Firewall is the built in firewall that comes with Mac OS X and must be enabled. Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the OS X firewall has been enabled, run the following command:<p></p><p></p>sudo /usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate<p></p><p></p>If the result is 'disabled', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To enable the firewall run the following command:<p></p><p></p>sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Enable Gatekeeper</td>
<td>Gatekeeper settings must be configured correctly to only allow the system to run applications downloaded from the Mac App Store. Administator users will still have the option to override these settings on a per app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple issued certificate in order to run. Digital signatures allow Mac OS X to verify that the application has not been modified by a malicious third party.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check to make sure only applications downloaded from the App Store are allowed to run, type the following code:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep AllowIdentifiedDevelopers | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the returned value is not '0', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Ensure Audit Logs are Kept for 1 Week or Longer</td>
<td>The audit service must be configured to require that records are kept for 7 days or longer before deletion when there is no central audit record storage facility. When expire-after is set to 7d, the audit service will not delete audit logs until the log data is at least 7 days old.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The check displays the amount of time the audit system is configured to retain audit log files. The audit system will not delete logs until the specified condition has been met. To view the current setting, run the following command:<p></p><p></p>sudo grep ^expire-after /etc/security/audit_control<p></p><p></p>If this returns no results, or does not contain 7d or a larger value, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Edit the /etc/security/audit_control file, and change the value for 'expire-after' to the amount of time audit logs should be kept for the system. Use the following command to set the 'expire-after' value to '7d':<p></p><p></p>sudo sed -i.bak 's/.*expire-after.*/expire-after:7d/' /etc/security/audit_control; sudo audit -s</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-4</td>
</tr>
<tr></tr>
<tr>
<td>Ensure Only root has the UID 0</td>
<td>The built in root account is disabled by default and administrator users are required to use sudo to run a process with the UID '0'. If another account with UID '0' exists, this is a sign of a network intrusion or a malicious user that is attempting to circumvent security controls.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To list all of the accounts with a UID of '0', run this command:<p></p><p></p>sudo dscl . -list /Users UniqueID | grep -w 0 | wc -l<p></p><p></p>If the result is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Investigate as to why any additional accounts were set up with a UID of '0'.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Install and Configure an Approved Anti-virus Application</td>
<td>An approved anti-virus product must be installed and configured to run.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Malicious software can establish a base on individual desktops and servers.  Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Ask the SA or IAO if an approved anti-virus solution is loaded on the system. The anti-virus solution may be bundled with an approved host-based security solution. If there is no local anti-virus solution installed on the system, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Install an approved anti-virus solution onto the system.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Install DoD-Approved Certificates to the System Keychain</td>
<td>DoD-approved certificates must be installed to the System Keychain so that they will be available to all users.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>For user certificates, each organization attains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice. This control focuses on certificates with a visibility external to the information system and does not include certificates related to internal system operations, for example, application-specific time services.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To view a list of installed certificates, run the following command:<p></p><p></p>sudo security dump-keychain | grep labl | awk -F\" '{ print $4 }'<p></p><p></p>If this list does not contain approved certificates, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Obtain the approved DOD certificates from the appropriate authority. Use Keychain Access from /Applications/Utilities to add certificates to the System keychain.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Lock Emergency Accounts after 72 Hours</td>
<td>Emergency administrator accounts are privileged accounts which are established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Emergency administrator accounts are different from infrequently used accounts (i.e., local login accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account which is created for use by vendors or system maintainers.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>To address access requirements, many operating systems can be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">If an emergency account has been created on the workstation, you can check the expiration settings using the following command:<p></p><p></p>sudo pwpolicy -u username get-effective-policy | tr ' ' '\n' | grep 'usingHardExpirationDate\|hardExpireDateGMT'<p></p><p></p>The value of 'usingHardExpirationDate' should be '1', and the value for the 'hardExpireDateGMT' should be a valid date.<p></p><p></p>Alternately, you can check if the account has been set to automatically expire after 72 hours using the following command:<p></p><p></p>sudo pwpolicy -u username get-effective-policy | tr ' ' '\n' | grep 'maxMinutesUntilDisabled'<p></p><p></p>The value of 'maxMinutesUntilDisabled' should be 4320.<p></p><p></p>If no expiration date is set, or if the account has not been configured to be automatically disabled after 72 hours, and password policy is not controlled by a directory server, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">If an emergency account has been created on the workstation, you can check the expiration settings using the following command:<p></p><p></p>sudo pwpolicy -u username getaccountpolicies | tail -n +2<p></p><p></p>If there is no output, and password policy is not controlled by a directory server, this is a finding.<p></p><p></p>Otherwise, look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'. In the array that follows, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that allows users to log in if 'policyAttributeCurrentTime' is less than the result of adding 'policyAttributeCreationTime' to 72hours (259299 seconds). The check might use a variable defined in its policyParameters section. If the check does not exist or if the check adds too great an amount of time to 'policyAttributeCreationTime', this is a finding."</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set an expiration date for an emergency account, use the following command:<p></p><p></p>sudo pwpolicy -u username setpolicy 'usingHardExpirationDate=1 hardExpireDateGMT=mm/dd/yy'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">This setting may be enforced using a configuration profile or by a directory server.<p></p><p></p>To set the password policy without a configuration profile, run the following command to save a copy of the current policy file for the specified username:<p></p><p></p>sudo pwpolicy -u username getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p></p><p></p>Open the resulting password policy file in a text editor. If other policy settings are present, and the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, insert the following text after the &lt;array&gt; tag that immediately follows it:<p></p><p></p>        &lt;dict&gt;<p></p>                &lt;key&gt;policyContent&lt;/key&gt;<p></p>                &lt;string&gt;policyAttributeCurrentTime &amp;lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p></p>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                &lt;string&gt;Disable Temporary Account&lt;/string&gt;<p></p>        &lt;/dict&gt;<p></p><p></p>At a minimum, edit the file to ensure that it contains the following text:<p></p><p></p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<p></p>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<p></p>&lt;plist version="1.0"&gt;<p></p>&lt;dict&gt;<p></p>        &lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p></p>        &lt;array&gt;<p></p>                &lt;dict&gt;<p></p>                        &lt;key&gt;policyContent&lt;/key&gt;<p></p>                        &lt;string&gt;policyAttributeCurrentTime &amp;lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p></p>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p></p>                        &lt;string&gt;Disable Temporary Account&lt;/string&gt;<p></p>                &lt;/dict&gt;<p></p>        &lt;/array&gt;<p></p>&lt;/dict&gt;<p></p>&lt;/plist&gt;<p></p><p></p>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p></p><p></p>sudo pwpolicy -u username setaccountpolicies pwpolicy.plist</fixtextyosemite></td>
<td>medium</td>
<td>AC-2 (2)</td>
</tr>
<tr>
<td>Lock the Screen with a Screensaver after 15 Minutes of Inactivity</td>
<td>A screensaver must be enabled and set to require a password to unlock. The timeout should be set to fifteen minutes of inactivity. This mitigates the risk that a user might forget to manually lock the screen before stepping away from the computer.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system, but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has a configuration profile configured to enable the screen saver after a time-out period, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep idleTime | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>The check should return a value of '900' or less, if not, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-11 a</td>
</tr>
<tr>
<td>Notify Administrators if Audit Has Insufficient Storage</td>
<td>The audit service must be configured to require a minimum percentage of free disk space in order to run. This ensures that audit will notify the administrator that action is required to free up more disk space for audit logs.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>When minfree is set to 25%, security personnel are notified immediately when the storage volume is 75% full and are able to plan for audit record storage capacity expansion.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The check displays the '% free' to leave available for the system. The audit system will not write logs if the volume has less than this percentage of free disk space. To view the current setting, run the following command:<p></p><p></p>sudo grep ^minfree /etc/security/audit_control<p></p><p></p>If this returns no results, or an incorrect setting for the organization, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Edit the /etc/security/audit_control file, and change the value for 'minfree' to the percentage of free space you require to keep available for the system. You can use the following command to set the 'minfree' value to '25%':<p></p><p></p>sudo sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; sudo audit -s</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-5 (1)</td>
</tr>
<tr>
<td>Notify Administrators of Auditing Failues</td>
<td>The audit service should be configured to immediately print messages to the console or email administrator users when an auditing failure occurs. It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">By default, auditd only logs errors to syslog. To verify if auditd has been configured to send immediate alerts to the SA or IAO, ask the SA if /etc/security/audit_warn has been configured to send emails or print alerts to the terminal window when audit errors occur. For example, to see if audit has been configured to print error messages to the console, run the following command:<p></p><p></p>sudo grep logger /etc/security/audit_warn<p></p><p></p>If the argument '-s' is missing, or if audit_warn has not been otherwise modified to print errors to the console or send email alerts to the SA and IAO, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To make auditd log errors to standard error as well as syslogd, run the following command:<p></p><p></p>sudo sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; sudo audit -s</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-5 (2)</td>
</tr>
<tr>
<td>Only Allow Authorized Applications</td>
<td>Application Restrictions must be enabled for user accounts and configured to only allow users to execute approved applications. Utilizing a whitelist such as Application Restrictions provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as whitelisting.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if there is a configuration policy defined for Application Restrictions, run the following command:<p></p><p></p>sudo profiles -Pv | grep 'Application Restrictions'<p></p><p></p>If nothing is returned, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-7 (5) (b)</td>
</tr>
<tr>
<td>Only Allow Authorized Users to Access System Logs</td>
<td>System logs should only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions, owner, group owner, and ACLs mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">This command checks for log files that exist on the system and prints out the log with corresponding ownership:<p></p><p></p>sudo stat -f '%Su:%Sg:%N' `grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }'` 2&gt; /dev/null<p></p><p></p>If there are any log files that are not owned by root and group-owned by wheel or admin, this is a finding.<p></p><p></p>This command checks for log files that exist on the system and prints out the log with corresponding permissions.<p></p><p></p>sudo stat -f '%A:%N' `grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }'` 2&gt; /dev/null<p></p><p></p>The correct permissions should be '640' or less permissive.  Any file with more permissive settings is a finding.<p></p><p></p>This command checks for log files that exist on the system and prints out the list of ACLs if there are any.<p></p><p></p>ls -le `grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }'` 2&gt; /dev/null<p></p><p></p>ACLs will be listed under any file that may contain them. i.e. '0: group:admin allow list,readattr,reaadextattr,readsecurity'  If any file contains this information, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">For any log file that returns an incorrect owner or group value, run the following command:<p></p><p></p>sudo chown root:wheel [log file]<p></p><p></p>[log file] is the full path to the log file in question.<p></p><p></p>For any log file that returns an incorrect permission value, run the following command:<p></p><p></p>sudo chmod 640 [log file]<p></p><p></p>[log file] is the full path to the log file in question.<p></p><p></p>For any log file that returns an ACL, run the following command:<p></p><p></p>sudo chmod -N [log file]<p></p><p></p>[log file] is the full path to the log file in question.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>SI-11 b</td>
</tr>
<tr>
<td>Only Allow Authorized Users to Delete Audit Logs</td>
<td>The audit service must be configured to create log files with the correct permissions to prevent normal users from deleting audit logs. If an unauthorized user is able to delete audit log files, that user could cover up traces of an attack. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check the permissions of the audit log files, run the following command:<p></p><p></p>sudo ls -le `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'` | grep -v current<p></p><p></p>The results should show the permissions (first column) to be 440 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>To check the permissions of the audit log folder, run the following command:<p></p><p></p>sudo ls -lde `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'`<p></p><p></p>The results should show the permissions (first column) to be 700 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>Additionally, no log file or log folder should contain ACLs. In the output from the above commands, ACLs will be listed under any file that may contain them (e.g., '0: group:admin allow list,readattr,reaadextattr,readsecurity' ). If any such line exists, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">For any log file or folder that returns an incorrect permission value, run the following command:<p></p><p></p>sudo chmod 440 [audit log file/folder]<p></p><p></p>[audit log file/folder] is the full path to the log file or folder in question.<p></p><p></p>For any log file or folder that returns an incorrect owner or group value, run the following command:<p></p><p></p>sudo chown root:wheel [audit log file/folder]<p></p><p></p>For any log file or folder that contains ACLs, run the following command:<p></p><p></p>sudo chmod -N [audit log file/folder]</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>AU-9</td>
</tr>
<tr>
<td>Only Allow Authorized Users to Modify Audit Logs</td>
<td>The audit service must be configured to create log files with the correct permissions to prevent normal users from modifying audit logs. If an unauthorized user is able to modify audit log files, that user could cover up traces of an attack. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check the permissions of the audit log files, run the following command:<p></p><p></p>sudo ls -le `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'` | grep -v current<p></p><p></p>The results should show the permissions (first column) to be 440 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>To check the permissions of the audit log folder, run the following command:<p></p><p></p>sudo ls -lde `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'`<p></p><p></p>The results should show the permissions (first column) to be 700 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>Additionally, no log file or log folder should contain ACLs. In the output from the above commands, ACLs will be listed under any file that may contain them (e.g., '0: group:admin allow list,readattr,reaadextattr,readsecurity' ). If any such line exists, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">For any log file or folder that returns an incorrect permission value, run the following command:<p></p><p></p>sudo chmod 440 [audit log file/folder]<p></p><p></p>[audit log file/folder] is the full path to the log file or folder in question.<p></p><p></p>For any log file or folder that returns an incorrect owner or group value, run the following command:<p></p><p></p>sudo chown root:wheel [audit log file/folder]<p></p><p></p>For any log file or folder that contains ACLs, run the following command:<p></p><p></p>sudo chmod -N [audit log file/folder]</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>AU-9</td>
</tr>
<tr>
<td>Only Allow Authorized Users to View Audit Logs</td>
<td>The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check the permissions of the audit log files, run the following command:<p></p><p></p>sudo ls -le `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'` | grep -v current<p></p><p></p>The results should show the permissions (first column) to be 440 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>To check the permissions of the audit log folder, run the following command:<p></p><p></p>sudo ls -lde `sudo grep '^dir' /etc/security/audit_control | awk -F: '{print $2}'`<p></p><p></p>The results should show the permissions (first column) to be 700 or less permissive, the owner (third column) to be root, and the group (fourth column) to be wheel. If not, this is a finding.<p></p><p></p>Additionally, no log file or log folder should contain ACLs. In the output from the above commands, ACLs will be listed under any file that may contain them (e.g., '0: group:admin allow list,readattr,reaadextattr,readsecurity' ). If any such line exists, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">For any log file or folder that returns an incorrect permission value, run the following command:<p></p><p></p>sudo chmod 440 [audit log file/folder]<p></p><p></p>[audit log file/folder] is the full path to the log file or folder in question.<p></p><p></p>For any log file or folder that returns an incorrect owner or group value, run the following command:<p></p><p></p>sudo chown root:wheel [audit log file/folder]<p></p><p></p>For any log file or folder that contains ACLs, run the following command:<p></p><p></p>sudo chmod -N [audit log file/folder]</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>AU-9</td>
</tr>
<tr>
<td>Prevent Bluetooth Devices from Waking the Computer</td>
<td>Bluetooth devices must not be allowed to wake the computer. If Bluetooth is not required, turn it off. If Bluetooth is necessary, disable allowing Bluetooth devices to wake the computer.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if this setting is disabled run the following command as the primary user:<p></p><p></p>defaults -currentHost read com.apple.Bluetooth RemoteWakeEnabled<p></p><p></p>If the return value is '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This control needs to be manually changed on the computer by opening System Preferences-&gt;Bluetooth, Click Advanced, and make sure the 'Allow Bluetooth devices to wake this computer' is not checked.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Prevent Users from Disabling Gatekeeper</td>
<td>Gatekeeper must be configured with a configuration profile in order to prevent normal users from overriding its setting. If users are allowed to disable Gatekeeper or set it to a less restrictive setting, then it is possible that malware could be introduced into the system. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple issued certificate in order to run. Digital signatures allow Mac OS X to verify that the application has not been modified by a malicious third party.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check to make sure the user cannot override Gatekeeper settings, type the following code:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep DisableOverride | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the returned value is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No Change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Prevent Users from Logging in as Root Directly</td>
<td>Administrator users must never log in directly as root. To assure individual accountability and prevent unauthorized access, logging in as root over a remote connection must be disabled. Administrators should only run commands as root after first authenticating with their individual user names and passwords.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if SSH has root logins enabled, run the following command:<p></p><p></p>sudo grep ^PermitRootLogin /etc/sshd_config<p></p><p></p>If there is no result, or the result is set to 'yes', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">In order to make sure that PermitRootLogin is disabled by sshd, run the following command:<p></p><p></p>sudo sed -i.bak 's/^[\#]*PermitRootLogin.*/PermitRootLogin no/' /etc/sshd_config</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No Change</fixtextyosemite></td>
<td>medium</td>
<td>IA-2 (5)</td>
</tr>
<tr>
<td>Prevent Users from Signing into iCloud</td>
<td>Users should not sign into iCloud, as this leads to the possibility that sensitive data could be saved to iCloud storage or that users could inadventently introduce viruses or malware previously saved to iCloud from other systems.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To see if any user account has configured an Apple ID for iCloud usage, run the following command:<p></p><p></p>sudo find /Users/ -name 'MobileMeAccounts.plist' -exec defaults read '{}' \;<p></p><p></p>If the results show any accounts listed, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This must be manually resolved.  With the affected user logged in, open System Preferences-&gt;iCloud.  Choose 'Sign Out'.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No Change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Prompt Users for a Username and Password</td>
<td>The login window must be configured to prompt all users for both a username and a password. By default, the system displays a list of known users at the login screen. This gives an advantage to an attacker with physical access to the system, as the attacker would only have to guess the password for one of the listed accounts.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the login window is configured to prompt for user name and password, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep SHOWFULLNAME | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If this setting is not defined, or not set to '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Remove the setuid Bit Unless Set by the Vendor</td>
<td>None of the executables that come preinstalled on Mac OS X have the setuid bit set, and administrators should never add the setuid bit to any executable that does not already have it set by the vendor. Executables with the setuid bit set allow anyone that executes them to be temporarily assigned the UID of the file owner. In practice, this almost always is the root account. While some vendors depend on this file attribute for proper operation, security problems can result if setuid is assigned to programs allowing reading and writing of files, or shell escapes, as this could lead to unprivileged users gaining privileged access to files and directories on the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To list all of the files with the setuid bit set, run the following command:<p></p><p></p>sudo find / -perm 4000 -exec ls -ldb {} \;<p></p><p></p>If any of the files listed are not documented as needing to have the setuid bit set by the vendor, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Document all of the files with the setuid bit set.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Require Users to Unlock the Screensaver with their Password</td>
<td>Users must be prompted to enter their passwords when unlocking the screensaver. The screensaver acts as a session lock and prevents unauthorized users from accessing the current user's account.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system has the correct setting in the configuration profile, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep 'askForPassword' | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>The check should return a value of '1'.  If this is not defined or not set to '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-11 b</td>
</tr>
<tr>
<td>Set a Default Screensaver for All Users</td>
<td>A default screensaver must be configured for all users, as the screensaver will act as a session time-out lock for the system and must be one that conceals the contents of the screen from unauthorized users. The screensaver must not display any sensitive information or reveal the contents of the locked session screen. Publicly viewable images can include static or dynamic images such as patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To view the currently selected screen saver for the logged in user, run the following command:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep moduleName<p></p><p></p>If there is no result or defined moduleName, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AC-11 (1)</td>
</tr>
<tr>
<td>Set Minimum Password Length to 15 Characters</td>
<td>The minimum password length must be set to 15 characters. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check the currently applied policies for password and accounts, use the following command:<p></p><p></p>sudo system_profiler SPConfigurationProfileDataType | grep minLength<p></p><p></p>The parameter minLength should be '15'.  If it is less than '15', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>IA-5 (1) (a)</td>
</tr>
<tr>
<td>Set the SSH Idle Timeout Interval and the Timeout for the Login Prompt</td>
<td>SSH should be configured to log users out after a 15 minute interval of inactivity and to only wait 30 seconds before timing out login attempts. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">The SSH daemon ClientAliveInterval option must be set correctly. To check the idle timeout setting for SSH sessions, run the following:<p></p><p></p>sudo grep ^ClientAliveInterval /etc/sshd_config<p></p><p></p>If the setting is not '600', this is a finding.<p></p><p></p>The SSH daemon ClientAliveCountMax option must be set correctly. To ensure the SSH idle timeout will occur when the 'ClientAliveCountMax' is set, run the following command:<p></p><p></p>sudo grep ^ClientAliveCountMax /etc/sshd_config<p></p><p></p>If the setting is not 'ClientAliveCountMax 0', this is a finding.<p></p><p></p>The SSH daemon LoginGraceTime must be set correctly. To check the amount of time that a user can login through SSH, run the following command:<p></p><p></p>sudo grep ^LoginGraceTime /etc/sshd_config<p></p><p></p>If the value is not set to '30' or less, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">In order to make sure that ClientAliveInterval is set correctly, run the following command:<p></p><p></p>sudo sed -i.bak 's/.*ClientAliveInterval.*/ClientAliveInterval 600/' /etc/sshd_config<p></p><p></p>In order to make sure that the SSH idle timeout occurs precisely when the 'ClientAliveCountMax' is set, run the following command:<p></p><p></p>sudo sed -i.bak 's/.*ClientAliveCountMax.*/ClientAliveCountMax 0/' /etc/sshd_config<p></p><p></p>In order to make sure that LoginGraceTime is configured correctly, run the following command:<p></p><p></p>sudo sed -i.bak 's/.*LoginGraceTime.*/LoginGraceTime 30/' /etc/sshd_config</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>SC-10</td>
</tr>
<tr>
<td>Set the Global Umask Setting for the System</td>
<td>The default global umask setting must be set to '022' for system processes. The setting '022' ensures that system process created files and directories will only be readable by other users and processes, not writable. This mitigates the risk that unauthorized users might be able to write to files and directories created by system processes. A more restrictive setting could potentially break the normal functionality of the system.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To view the umask setting, run the following command:<p></p><p></p>umask<p></p><p></p>If the setting is not '0022', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the umask setting for applications, run the following command:<p></p><p></p>sudo sh -c 'echo 'umask 022' &gt; /etc/launchd.conf'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">YOSEMITE CHANGE</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Set the Global Umask Setting for Users</td>
<td>The default global umask setting must be set to '027' for user applications. The setting '027' ensures that user created files and directories will be readable, but not writable, by users that share the same group id. Users with a different group id will not be able to read or write those files. This mitigates the risk that unauthorized users might be able to read and write files saved to the system by user applications.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To view the umask setting, run the following command:<p></p><p></p>awk '{ print $2 }' /etc/launchd-user.conf<p></p><p></p>If the command produces an error, or the result is not '027', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">YOSEMITE CHANGE</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To set the umask setting for user applications, run the following command:<p></p><p></p>sudo sh -c 'echo 'umask 027' &gt; /etc/launchd-user.conf'</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">YOSEMITE CHANGE</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Set the Owner of Public Directories to root or a System Account</td>
<td>All public directories must be owned by root, the local admin user, or an application account. Directory owners have permission to delete any files contained in that directory, even if the files are owned by other user accounts. By setting the owner to an administrator or application account, regular users will not be permitted to delete each other's files.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To display all directories that are writable by all and not owned by root, run the following command:<p></p><p></p>sudo find / -type d -perm +o+w -not -uid 0<p></p><p></p>If anything is returned, and those directories are not owned by a local admin or application account, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To change the ownership of any finding, run the following command:<p></p><p></p>sudo find / -type d -perm +o+w -not -uid 0 -exec chown root {} \;</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Set the Sticky Bit on Public Directories</td>
<td>The sticky bit must be set on all public directories, as it prevents users with write access to the directory from deleting or renaming files that belong to other users inside it.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">Run the following command to view all world-writable directories that have the sticky bit set:<p></p><p></p>sudo find / -type d \( -perm -0002 -a ! -perm -1000 \)<p></p><p></p>If anything is returned, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Run the following command to set the sticky bit on all world-writable directories:<p></p><p></p>sudo find / -type d \( -perm -0002 -a ! -perm -1000 \) -exec chmod +t {} \;</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Set Trash to Securely Erase Items</td>
<td>Finder must be configured to always empty Trash securely in order to prevent data recovery tools from accessing the deleted files. Files emptied from the Trash by normal means are still present on the hard drive and can be recovered up until the moment the system overwrites that particular location on disk. A malicious user with physical access to a system could take advantage of this property to access potentially sensitive files that the normal system owner or user assumed were safely deleted. Configuring Finder to always empty trash securely mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check that the finder will only present the option to securely empty trash run the following command as the primary user:<p></p><p></p>system_profiler SPConfigurationProfileDataType | grep EmptyTrashSecurely | awk '{ print $3 }' | sed 's/;//'<p></p><p></p>If the result does not return a setting, or the setting is not '1', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">This setting is enforced using a configuration profile.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1"></fixtextyosemite></td>
<td>low</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Shut down the Computer if Auditing Fails</td>
<td>The audit service should shut down the computer if it is unable to audit system events. Once audit failure occurs, user and system activitity is no longer recorded and malicious activity could go undetected. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>When availability is an overriding concern, other approved actions in response to an audit failure are as follows: <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner. <p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To view the setting for the audit control system, run the following command:<p></p><p></p>sudo grep ^policy /etc/security/audit_control | grep ahlt<p></p><p></p>If there is no result, this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Edit the /etc/security/audit_control file, and change the value for policy to include the setting 'ahlt'. To programmatically do this, run the following command:<p></p><p></p>sudo sed -i.bak '/^policy/ s/$/,ahlt/' /etc/security/audit_control; sudo audit -s</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>AU-5 b</td>
</tr>
<tr>
<td>Turn on FileVault Disk Encryption</td>
<td>FileVault Disk Encryption must be enabled. By encrypting the system hard drive, the confidentiality and integrity of any data stored on the system is ensured.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. FileVault Disk Encryption mitigates this risk.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if FileVault 2 is enabled, run the following command:<p></p><p></p>sudo fdesetup status<p></p><p></p>If FileVault is 'Off', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open System Preferences-&gt;Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p></p><p></p>Alternately, from the command line, run the following command to enable FileVault:<p></p><p></p>sudo fdesetup enable<p></p><p></p>After FileVault is initially set up, additional users can be added.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>SC-28</td>
</tr>
<tr>
<td>Turn on FileVault Disk Encryption</td>
<td>FileVault Disk Encryption must be enabled. This ensures that any data stored on the hard drive will be protected by cryptographic means when the system is powered off, mitigating the risk of unauthorized modification of that data.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields).</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if FileVault 2 is enabled, run the following command:<p></p><p></p>sudo fdesetup status<p></p><p></p>If FileVault is 'Off', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open System Preferences-&gt;Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p></p><p></p>Alternately, from the command line, run the following command to enable FileVault:<p></p><p></p>sudo fdesetup enable<p></p><p></p>After FileVault is initially set up, additional users can be added.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>SC-28 (1)</td>
</tr>
<tr>
<td>Turn on FileVault Disk Encryption</td>
<td>FileVault Disk Encryption must be enabled. This ensures that any data stored on the hard drive will be protected by cryptographic means when the system is powered off, mitigating the risk of unauthorized disclosure of that data.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields).</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if FileVault 2 is enabled, run the following command:<p></p><p></p>sudo fdesetup status<p></p><p></p>If FileVault is 'Off', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">Open System Preferences-&gt;Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p></p><p></p>Alternately, from the command line, run the following command to enable FileVault:<p></p><p></p>sudo fdesetup enable<p></p><p></p>After FileVault is initially set up, additional users can be added.</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>SC-28 (1)</td>
</tr>
<tr>
<td>Turn on Firewall Logging</td>
<td>Firewall logging must be enabled. This ensures that malicious network activity will be logged to the system. This requirement is NA if HBSS is used.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the OS X firewall has logging enabled, run the following command:<p></p><p></p>/usr/libexec/ApplicationFirewall/socketfilterfw --getloggingmode | grep on<p></p><p></p>If the result does not show 'on', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To enable the firewall logging, run the following command:<p></p><p></p>sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr>
<td>Turn on Secure Virtual Memory</td>
<td>Secure virtual memory must be enabled. Secure virtual memory ensures that data in memory is encrypted when it is swapped to disk. This prevents users and applications from accessing potentially sensitive information, such as user names and passwords, from the swap space on the hard drive.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check if the system is using secure virtual memory run the following command:<p></p><p></p>sysctl vm.swapusage<p></p><p></p>If the result does not show '(encrypted)', this is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To ensure secure virtual memory is secure, run the following command:<p></p><p></p>sudo defaults write /Library/Preferences/com.apple.virtualMemory DisableEncryptedSwap -bool FALSE</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-6 b</td>
</tr>
<tr></tr>
<tr>
<td>Verify Default File Permissions</td>
<td>File permissions should be compared against the default set of permissions that were set at the time of the initial install. Changes to default file permissions can make the system less secure and disrupt the functionality of installed applications. Unless changes are required to harden a system, the default permissions should be kept. If the operating system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. Verifying that permissions remain unchanged mitigates this risk.<p xmlns="http://checklists.nist.gov/xccdf/1.1"></p><p xmlns="http://checklists.nist.gov/xccdf/1.1"></p>This requirement applies to operating systems with software libraries that are accessible and configurable, as in the case of interpreted languages. Software libraries also include privileged programs which execute with escalated privileges. Only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.</td>
<td><check xmlns="http://checklists.nist.gov/xccdf/1.1">To check the permissions and ownership of the system files and make sure they haven't changed from the original installation, run the following command:<p></p><p></p>sudo diskutil verifyPermissions /<p></p><p></p>Any results indicating User/Group/Permissions differ is a finding.</check></td>
<td><checkyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</checkyosemite></td>
<td><fixtext xmlns="http://checklists.nist.gov/xccdf/1.1">To correct ownership and permissions of files found in the check, run the following command:<p></p><p></p>sudo diskutil repairPermissions /</fixtext></td>
<td><fixtextyosemite xmlns="http://checklists.nist.gov/xccdf/1.1">No change</fixtextyosemite></td>
<td>medium</td>
<td>CM-5 (6)</td>
</tr>
</table>
</body>
</html>
