<?xml version="1.0"?>
<Benchmark xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dc="http://purl.org/dc/elements/1.1/" id="MacOSX10.11">
<status date="2016-02-02">draft</status>
  <title>DoD Consensus Settings for Mac OS X 10.11</title>
  <description>These security settings for Mac OS X 10.11
  were developed by the DoD Joint Consensus Working Group.
  </description>
  <!-- Many of the XCCDF elements used here 
       are not used in the manner originally intended by
       the XCCDF specification; 
       this is a result of the SRG-based process,
       which mixes requirements about security functionality
       with requirements for security configuration. -->
<Rule severity="low" id="Set a Default Screensaver for All Users">
<title>Set a Default Screensaver for All Users</title>
<description>This setting is enforced using the "Login Window Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000060</reference>
<ident srgid="SRG-OS-000031" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To view the currently selected screen saver for the logged in user, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep moduleName<p/><p/>If there is no result or defined moduleName, this is a finding.</check-content></check>
<rationale>The operating system must conceal, via the session lock, information previously visible on the display with a publicly viewable image.</rationale>
</Rule>

<Rule severity="medium" id="Set a Screensaver Timeout of 15 Minutes or Less">
<title>Set a Screensaver Timeout of 15 Minutes or Less</title>
<description>This setting is enforced using the "Login Window Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000057</reference>
<ident srgid="SRG-OS-000029" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system has a configuration profile configured to enable the screen saver after a time-out period, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep idleTime<p/><p/>The check should return a value of '900' or less for idleTime. If not, this is a finding.</check-content></check>
<rationale>The operating system must initiate a session lock after a 15-minute period of inactivity.</rationale>
</Rule>

<Rule severity="medium" id="Require a Password to Unlock the Screensaver">
<title>Require a Password to Unlock the Screensaver</title>
<description>This setting is enforced using the "Login Window Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-11 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000056</reference>
<ident srgid="SRG-OS-000028" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system will prompt users to enter their passwords to unlock the screensaver, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep askForPassword<p/><p/>If there is no result, or if askForPassword is not set to '1', this is a finding.</check-content></check>
<rationale>The operating system must retain the session lock until the user reestablishes access using established identification and authentication procedures.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Login Events">
<title>Configure the Audit Daemon to Log Login Events</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000067</reference>
<ident srgid="SRG-OS-000032" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check to make sure the audit daemon is configured to log all login events, both local and remote, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>The flag 'lo' should be included in the list of flags set. If it is not, this is a finding.</check-content></check>
<rationale>The operating system must monitor remote access methods.</rationale>
</Rule>

<Rule severity="high" id="Disable the rexec Service">
<title>Disable the rexec Service</title>
<description>To disable the 'rexec' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.rexecd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000068</reference>
<ident srgid="SRG-OS-000033" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'rexec' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.rexecd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.rexecd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must implement DoD-approved encryption to protect the confidentiality of remote access sessions.</rationale>
</Rule>

<Rule severity="high" id="Disable the Telnet service">
<title>Disable the Telnet service</title>
<description>To disable the 'rexec' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-17 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001453</reference>
<ident srgid="SRG-OS-000250" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'telnet' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.telnetd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must implement cryptography to protect the integrity of remote access sessions.</rationale>
</Rule>

<Rule severity="high" id="Disable the rshd Service">
<title>Disable the rshd Service</title>
<description>To disable the 'rshd' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.rshd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'rshd' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.rshd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.rshd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The rshd service must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable Screen Sharing">
<title>Disable Screen Sharing</title>
<description>To disable the 'screen sharing' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'screen sharing' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.screensharing<p/><p/>If the results do not show the following:<p/><p/>"com.apple.screensharing" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must enforce requirements for remote connections to the information system.</rationale>
</Rule>

<Rule severity="low" id="Disable Bluetooth Devices">
<title>Disable Bluetooth Devices</title>
<description>This setting is enforced using the "Bluetooth Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If Bluetooth connectivity is required to facilitate use of approved external devices, this is not applicable.<p/><p/>To check if Bluetooth is disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableBluetooth<p/><p/>If there is no result, or if DisableBluetooth is not set to '1', this is a finding.</check-content></check>
<rationale>The Bluetooth software driver must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable the Wi-Fi Network Device">
<title>Disable the Wi-Fi Network Device</title>
<description>To disable the Wi-Fi network device, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -setnetworkserviceenabled 'Wi-Fi' off</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If the system requires Wi-Fi to connect to an authorized network, this is not applicable.<p/><p/>To check if the Wi-Fi network device is disabled, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -listallnetworkservices<p/><p/>A disabled device will have an asterisk in front of its name. If the Wi-Fi device is missing this asterisk, this is a finding.</check-content></check>
<rationale>Wi-Fi support software must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable the Infrared Controller">
<title>Disable the Infrared Controller</title>
<description>To disable IR, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled -bool FALSE</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if IR support is disabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled<p/><p/>If the result is not '0', this is a finding.</check-content></check>
<rationale>Infrared [IR] support must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Blank CDs from Generating Prompts">
<title>Prevent Blank CDs from Generating Prompts</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To check if the system has the correct setting for blank CDs in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 2 'com.apple.digihub.blank.cd.appeared'<p/><p/>If this is not defined or 'action' is not set to '1', this is a finding.</check-content></check>
<rationale>Automatic actions must be disabled for blank CDs.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Blank DVDs from Generating Prompts">
<title>Prevent Blank DVDs from Generating Prompts</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To check if the system has the correct setting for blank DVDs in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 2 'com.apple.digihub.blank.dvd.appeared'<p/><p/>If this is not defined or 'action' is not set to '1', this is a finding.</check-content></check>
<rationale>Automatic actions must be disabled for blank DVDs.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Music CDs from Generating Prompts">
<title>Prevent Music CDs from Generating Prompts</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To check if the system has the correct setting for music CDs in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 2 'com.apple.digihub.cd.music.appeared'<p/><p/>If this is not defined or 'action' is not set to '1', this is a finding.</check-content></check>
<rationale>Automatic actions must be disabled for music CDs.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Picture CDs from Generating Prompts">
<title>Prevent Picture CDs from Generating Prompts</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To check if the system has the correct setting for picture CDs in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 2 'com.apple.digihub.cd.picture.appeared'<p/><p/>If this is not defined or 'action' is not set to '1', this is a finding.</check-content></check>
<rationale>Automatic actions must be disabled for picture CDs.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Video DVDs from Generating Prompts">
<title>Prevent Video DVDs from Generating Prompts</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To check if the system has the correct setting for video DVDs in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 2 'com.apple.digihub.dvd.video.appeared'<p/><p/>If this is not defined or 'action' is not set to '1', this is a finding.</check-content></check>
<rationale>Automatic actions must be disabled for video DVDs.</rationale>
</Rule>

<Rule severity="medium" id="Remove or Disable Temporary User Accounts">
<title>Remove or Disable Temporary User Accounts</title>
<description>This setting may be enforced using a configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current policy file, substituting the correct user name in place of username:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the resulting password policy file in a text editor.<p/><p/>If other policy settings are present, and the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, insert the following text after the &lt;array&gt; tag that immediately follows it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributeCurrentTime &lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Disable Temporary Account&lt;/string&gt;<p/>&lt;/dict&gt;<p/><p/>At a minimum, edit the file to ensure that it contains the following text:<p/><p/>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<p/>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<p/>&lt;plist version="1.0"&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributeCurrentTime &lt; policyAttributeCreationTime + 259299&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Disable Temporary Account&lt;/string&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/>&lt;/dict&gt;<p/>&lt;/plist&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the correct user name in place of username:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username setaccountpolicies pwpolicy.plist</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000016</reference>
<ident srgid="SRG-OS-000002" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with the pwpolicy utility. The variable names may vary depending on how the policy was set. To check if the password policy is configured to disable a temporary account after 72 hours, run the following command to output the password policy to the screen, substituting the correct user name in place of username:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2<p/><p/>If there is no output, and password policy is not controlled by a directory server, this is a finding.<p/><p/>Otherwise, look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'.<p/><p/>In the array that follows, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that allows users to log in if 'policyAttributeCurrentTime' is less than the result of adding 'policyAttributeCreationTime' to 72hours (259299 seconds). The check might use a variable defined in its policyParameters section.<p/><p/>If the check does not exist or if the check adds too great an amount of time to 'policyAttributeCreationTime', this is a finding.</check-content></check>
<rationale>The operating system must automatically remove or disable temporary user accounts after 72 hours.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Emergency Administrator Accounts from Expiring">
<title>Prevent Emergency Administrator Accounts from Expiring</title>
<description>To remove all pwpolicy settings for an emergency account, run the following command, replacing username with the correct value:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username clearaccountpolicies<p/><p/>Otherwise, to change the password policy for an emergency account and only remove some policy sections, run the following command to save a copy of the current policy file for the specified username:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the resulting password policy file in a text editor and remove any policyContent sections that would restrict the ability to log on after a certain date or amount of time.<p/><p/>To remove the section cleanly, remove the entire text that begins with &lt;dict&gt;, contains the like &lt;key&gt;policyContent&lt;'/key&gt;, and ends with &lt;/dict&gt;.<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username setaccountpolicies pwpolicy.plist</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001682</reference>
<ident srgid="SRG-OS-000123" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an emergency account has been created on the workstation, check the expiration settings of a local account using the following command, replacing username with the correct value:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2<p/><p/>If there is output, ensure that the account policies do not restrict the ability to log on after a certain date or amount of time. If they do, this is a finding.</check-content></check>
<rationale>The operating system must be configured such that emergency administrator accounts are never automatically disabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Account Creation">
<title>Configure the Audit Daemon to Log Account Creation</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (4)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000018</reference>
<ident srgid="SRG-OS-000004" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>The account creation events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must automatically audit account creation.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Account Modification">
<title>Configure the Audit Daemon to Log Account Modification</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (4)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001403</reference>
<ident srgid="SRG-OS-000239" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>The account creation events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must automatically audit account modification.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Account Disablement">
<title>Configure the Audit Daemon to Log Account Disablement</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (4)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001404</reference>
<ident srgid="SRG-OS-000240" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>The account modification events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must automatically audit account disabling actions.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Account Removal">
<title>Configure the Audit Daemon to Log Account Removal</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2 (4)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001405</reference>
<ident srgid="SRG-OS-000241" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>The account modification events are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must automatically audit account removal actions.</rationale>
</Rule>

<Rule severity="medium" id="Disable the SMB File Sharing Service">
<title>Disable the SMB File Sharing Service</title>
<description>To disable the 'SMB File Sharing' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.smbd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If SMB File Sharing is required, this is not applicable.<p/><p/>To check if the 'SMB File Sharing' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.smbd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.smbd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>SMB File Sharing must be disabled unless required.</rationale>
</Rule>

<Rule severity="medium" id="Disable the Apple File (AFP) Sharing Service">
<title>Disable the Apple File (AFP) Sharing Service</title>
<description>To disable the 'Apple File (AFP) Sharing' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.AppleFileServer<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Apple File (AFP) Sharing' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.AppleFileServer<p/><p/>If the results do not show the following:<p/><p/>"com.apple.AppleFileServer" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Apple File (AFP) Sharing must be disabled unless required.</rationale>
</Rule>

<Rule severity="medium" id="Disable the NFS Sharing Service">
<title>Disable the NFS Sharing Service</title>
<description>To disable the 'NFS' daemon, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If the NFS daemon is required, this is not applicable.<p/><p/>To check if the NFS daemon is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.nfsd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.nfsd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The NFS daemon must be disabled unless required.</rationale>
</Rule>

<Rule severity="medium" id="Disable the NFS Lock Daemon">
<title>Disable the NFS Lock Daemon</title>
<description>To disable the 'NFS lock' daemon, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.lockd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If the NFS lock daemon is required, this is not applicable.<p/><p/>To check if the NFS lock daemon is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.lockd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.lockd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The NFS lock daemon must be disabled unless required.</rationale>
</Rule>

<Rule severity="medium" id="Disable the NFS Stat Daemon">
<title>Disable the NFS Stat Daemon</title>
<description>To disable the 'NFS stat' daemon, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.statd.notify<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If the NFS stat daemon is required, this is not applicable.<p/><p/>To check if the NFS stat daemon is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.statd.notify<p/><p/>If the results do not show the following:<p/><p/>"com.apple.statd.notify" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The NFS stat daemon must be disabled unless required.</rationale>
</Rule>

<Rule severity="medium" id="Configure a Firewall to Deny Access by Default">
<title>Configure a Firewall to Deny Access by Default</title>
<description>Install an approved HBSS or firewall solution onto the system and configure it with a default-deny policy.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-4</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The system firewall must be configured with a default-deny policy. Ask the SA or ISSO if an approved firewall is loaded on the system. The recommended system is the McAfee HBSS.<p/><p/>If there is no firewall installed on the system, this is a finding. <p/><p/>If there is a firewall installed and it is not configured with a default deny policy, this is a finding.</check-content></check>
<rationale>The system firewall must be configured with a default-deny policy.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Privileged Commands">
<title>Configure the Audit Daemon to Log Privileged Commands</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000471" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Privileged activities are logged by way of the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records for privileged activities or other system-level access.</rationale>
</Rule>

<Rule severity="low" id="Configure the System to Display a Consent to Monitoring Banner Message">
<title>Configure the System to Display a Consent to Monitoring Banner Message</title>
<description>Create a RTF formatted file containing the required text. Name the file PolicyBanner.rtf or PolicyBanner.rtfd and place it in /Library/Security/</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-8 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000048</reference>
<ident srgid="SRG-OS-000023" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The policy banner will show if a PolicyBanner.rtf or PolicyBanner.rtfd exists in the /Library/Security folder. Run this command to show the contents of that folder:<p/><p/>/bin/ls -l /Library/Security/PolicyBanner.rtf*<p/><p/>If neither PolicyBanner.rtf nor PolicyBanner.rtfd exists, this is a finding.<p/><p/>The banner text of the document MUST read:<p/><p/>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p/>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p/>-At any time, the USG may inspect and seize data stored on this IS.<p/>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<p/>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p/>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<p/><p/>If the text is not worded exactly this way, this is a finding.</check-content></check>
<rationale>The operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via the GUI.</rationale>
</Rule>

<Rule severity="low" id="Create a Consent to Monitoring Banner Message">
<title>Create a Consent to Monitoring Banner Message</title>
<description>For systems that allow remote access through SSH, create a plain text file containing the required text and save it as /etc/banner.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-8 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000048</reference>
<ident srgid="SRG-OS-000023" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>For systems that allow remote access through SSH, run the following command to ensure that /etc/banner exists:<p/><p/>/bin/ls -l /etc/banner<p/><p/>If /etc/banner does not exist, this is a finding.<p/><p/>The banner text of the document MUST read:<p/><p/>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p/>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p/>-At any time, the USG may inspect and seize data stored on this IS.<p/>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<p/>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p/>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."<p/><p/>If the text is not worded exactly this way, this is a finding.</check-content></check>
<rationale>The SSH banner must contain the Standard Mandatory DoD Notice and Consent Banner.</rationale>
</Rule>

<Rule severity="low" id="Configure the SSH Daemon to Display a Consent to Monitoring Banner Message">
<title>Configure the SSH Daemon to Display a Consent to Monitoring Banner Message</title>
<description>For systems that allow remote access through SSH, modify the /etc/ssh/sshd_config file to add or update the following line:<p/><p/>Banner /etc/issue</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-8 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000048</reference>
<ident srgid="SRG-OS-000023" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>For systems that allow remote access through SSH, run the following command to ensure that a banner is displayed before granting access:<p/><p/>/usr/bin/grep Banner /etc/ssh/sshd_config<p/><p/>If the sshd Banner configuration option does not point to a file, this is a finding.</check-content></check>
<rationale>The operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system via SSH.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Display a Consent to Monitoring Banner Message">
<title>Configure the System to Display a Consent to Monitoring Banner Message</title>
<description>Create a RTF formatted file containing the required text.  Name the file PolicyBanner.rtf or PolicyBanner.rtfd and place it in /Library/Security/</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-8 c 1, AC-8 c 2, AC-8 c 3</reference>
<reference href="http://iase.disa.mil/cci/index.html">001384</reference>
<ident srgid="SRG-OS-000228" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The policy banner will show if a PolicyBanner.rtf or PolicyBanner.rtfd exists in the /Library/Security folder. Run this command to show the contents of that folder:<p/><p/>/bin/ls -l /Library/Security/PolicyBanner.rtf*<p/><p/>If neither PolicyBanner.rtf nor PolicyBanner.rtfd exists, this is a finding. <p/><p/>The banner text of the document MUST read:<p/><p/>"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:<p/>-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.<p/>-At any time, the USG may inspect and seize data stored on this IS.<p/>-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.<p/>-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.<p/>-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants.  Such communications and work product are private and confidential. See User Agreement for details."<p/><p/>If the text is not worded exactly this way, this is a finding.</check-content></check>
<rationale>Any publically accessible connection to the operating system must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Successful and Unsuccessful Logins">
<title>Configure the Audit Daemon to Log Successful and Unsuccessful Logins</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000470" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Logon events are logged by way of the 'aa' flag.  If 'aa' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful logon attempts occur.</rationale>
</Rule>

<Rule severity="medium" id="Enable the Audit Daemon">
<title>Enable the Audit Daemon</title>
<description>To enable the audit service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-14 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001464</reference>
<ident srgid="SRG-OS-000254" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the audit service is running, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl list | /usr/bin/grep com.apple.auditd<p/><p/>If nothing is returned, the audit service is not running and this is a finding.</check-content></check>
<rationale>The operating system must initiate session audits at system startup.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log DoD Mandated Events">
<title>Configure the Audit Daemon to Log DoD Mandated Events</title>
<description>To set the audit flags to the recommended setting, run the following command to add the flags 'lo', 'ad', and 'aa' all at once:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,lo,ad,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000169</reference>
<ident srgid="SRG-OS-000062" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The options to configure the audit daemon are located in the /etc/security/audit_control file.  To view the current settings, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>If the 'lo', 'ad', and 'aa' options are not set, this is a finding.</check-content></check>
<rationale>The operating system must provide audit record generation capability for DoD-defined auditable events for all operating system components.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Account Creation, Modification, Disablement, and Deletion">
<title>Configure the Audit Daemon to Log Account Creation, Modification, Disablement, and Deletion</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000476" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Privileged access, including the creation, modification, and deletion of local user accounts, is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records for all account creations, modifications, disabling, and termination events.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Retain Data for 7 Days or Longer">
<title>Configure the Audit Daemon to Retain Data for 7 Days or Longer</title>
<description>Edit the /etc/security/audit_control file, and change the value for 'expire-after' to the amount of time audit logs should be kept for the system. Use the following command to set the 'expire-after' value to '7d':<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-4</reference>
<reference href="http://iase.disa.mil/cci/index.html">001849</reference>
<ident srgid="SRG-OS-000341" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The check displays the amount of time the audit system is configured to retain audit log files. The audit system will not delete logs until the specified condition has been met. To view the current setting, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^expire-after /etc/security/audit_control<p/><p/>If this returns no results, or does not contain 7d or a larger value, this is a finding.</check-content></check>
<rationale>The operating system must allocate audit record storage capacity to store at least one weeks worth of audit records, when audit records are not immediately sent to a central audit record storage facility.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Warn Administrators if Free Disk Space is below 25%">
<title>Configure the Audit Daemon to Warn Administrators if Free Disk Space is below 25%</title>
<description>Edit the /etc/security/audit_control file, and change the value for 'minfree' to 25. Use the following command to set the 'minfree' value to '25%':<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001855</reference>
<ident srgid="SRG-OS-000343" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The check displays the '% free' to leave available for the system. The audit system will not write logs if the volume has less than this percentage of free disk space. To view the current setting, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^minfree /etc/security/audit_control<p/><p/>If this returns no results, or does not contain 25, this is a finding.</check-content></check>
<rationale>The operating system must provide an immediate warning to the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75% of repository maximum audit record storage capacity.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Print Auditing Daemon Failures to the Console">
<title>Configure the Audit Daemon to Print Auditing Daemon Failures to the Console</title>
<description>To make auditd log errors to standard error as well as syslogd, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/bin/sudo /usr/sbin/audit -s</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001858</reference>
<ident srgid="SRG-OS-000344" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>By default, auditd only logs errors to syslog. To see if audit has been configured to print error messages to the console, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep logger /etc/security/audit_warn<p/><p/>If the argument '-s' is missing, or if audit_warn has not been otherwise modified to print errors to the console or send email alerts to the SA and ISSO, this is a finding.</check-content></check>
<rationale>The operating system must provide an immediate real-time alert to the SA and ISSO, at a minimum, of all audit failure events requiring real-time alerts.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Use an Authorized Time Server">
<title>Configure the System to Use an Authorized Time Server</title>
<description>To enable the NTP service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl load -w /System/Library/LaunchDaemons/org.ntp.ntpd.plist<p/><p/>To configure one or more time servers for use, edit /etc/ntp.conf and enter each hostname or ip address on a separate line, prefixing each one with the keyword "server".</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-8 (1) (a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001891</reference>
<ident srgid="SRG-OS-000355" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The Network Time Protocol (NTP) service must be enabled on all networked systems. To check if the service is running, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl list | grep org.ntp.ntpd<p/><p/>If nothing is returned, this is a finding.<p/><p/>To ensure that an authorized NTP server is configured, run the following command or examine /etc/ntp.conf:<p/><p/>/usr/bin/sudo /usr/bin/grep ^server /etc/ntp.conf<p/><p/>Only approved time servers should be configured for use. If no server is configured, or if an unapproved time server is in use, this is a finding.</check-content></check>
<rationale>The operating system must, for networked systems, compare internal information system clocks at least every 24 hours with a server which is synchronized to one of the redundant United States Naval Observatory (USNO) time servers or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Logs are Owned By Root">
<title>Ensure Audit Logs are Owned By Root</title>
<description>For any log file that returns an incorrect owner, run the following command:<p/><p/>/usr/bin/sudo chown root [audit log file]<p/><p/>[audit log file] is the full path to the log file in question.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the ownership of the audit log files, run the following command:<p/><p/>/usr/bin/sudo ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}') | grep -v current<p/><p/>The results should show the owner (third column) to be root. If not, this is a finding.</check-content></check>
<rationale>Audit log files must be owned by root.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Log Folders are Owned By Root">
<title>Ensure Audit Log Folders are Owned By Root</title>
<description>For any log folder that has an incorrect owner, run the following command:<p/><p/>/usr/bin/sudo chown root [audit log folder]</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the ownership of the audit log folder, run the following command:<p/><p/>/usr/bin/sudo ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}')<p/><p/>The results should show the owner (third column) to be root. If not, this is a finding.</check-content></check>
<rationale>Audit log folders must be owned by root.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Logs are Group Owned By Root">
<title>Ensure Audit Logs are Group Owned By Root</title>
<description>For any log file that returns an incorrect group-0owner, run the following command:<p/><p/>/usr/bin/sudo chgrp wheel [audit log file]<p/><p/>[audit log file] is the full path to the log file in question.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the group-ownership of the audit log files, run the following command:<p/><p/>/usr/bin/sudo ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}') | /usr/bin/grep -v current<p/><p/>The results should show the group owner (fourth column) to be wheel. If not, this is a finding.</check-content></check>
<rationale>Audit log files must be group-owned by wheel.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Log Folders are Group Owned by Root">
<title>Ensure Audit Log Folders are Group Owned by Root</title>
<description>For any log folder that has an incorrect group, run the following command:<p/><p/>/usr/bin/sudo chgrp wheel [audit log folder]</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the group-ownership of the audit log folder, run the following command:<p/><p/>/usr/bin/sudo ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}')<p/><p/>The results should show the group (fourth column) to be wheel. If not, this is a finding.</check-content></check>
<rationale>Audit log folders must be group-owned by wheel.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Log Permissions are 440 or Less Permissive">
<title>Ensure Audit Log Permissions are 440 or Less Permissive</title>
<description>For any log file that returns an incorrect permission value, run the following command:<p/><p/>/usr/bin/sudo chmod 440 [audit log file]<p/><p/>[audit log file] is the full path to the log file in question.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the permissions of the audit log files, run the following command:<p/><p/>/usr/bin/sudo ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}') | /usr/bin/grep -v current<p/><p/>The results should show the permissions (first column) to be 440 or less permissive. If not, this is a finding.</check-content></check>
<rationale>Audit log files must be mode 440 or less permissive.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Log Folders are 700 or Less Permissive">
<title>Ensure Audit Log Folders are 700 or Less Permissive</title>
<description>For any log folder that returns an incorrect permission value, run the following command:<p/><p/>/usr/bin/sudo chmod 700 [audit log folder]</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the permissions of the audit log folder, run the following command:<p/><p/>/usr/bin/sudo ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}')<p/><p/>The results should show the permissions (first column) to be 700 or less permissive. If not, this is a finding.</check-content></check>
<rationale>Audit log folders must have mode 700 or less permissive.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Logs Have No ACL Permissions">
<title>Ensure Audit Logs Have No ACL Permissions</title>
<description>For any log file that contains ACLs, run the following command:<p/><p/>/usr/bin/sudo chmod -N [audit log file]</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if a log file contains ACLs, run the following commands:<p/><p/>/usr/bin/sudo ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}') | /usr/bin/grep -v current<p/><p/>In the output from the above commands, ACLs will be listed under any file that may contain them (e.g., '0: group:admin allow list,readattr,reaadextattr,readsecurity'). If any such line exists, this is a finding.</check-content></check>
<rationale>Log files must not contain ACLs.</rationale>
</Rule>

<Rule severity="medium" id="Ensure Audit Log Folders Have No ACL Permissions">
<title>Ensure Audit Log Folders Have No ACL Permissions</title>
<description>For any log folder that contains ACLs, run the following command:<p/><p/>/usr/bin/sudo chmod -N [audit log folder]</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-9</reference>
<reference href="http://iase.disa.mil/cci/index.html">000162</reference>
<ident srgid="SRG-OS-000057" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if a log folder contains ACLs, run the following commands:<p/><p/>/usr/bin/sudo ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | awk -F: '{print $2}')<p/><p/>In the output from the above commands, ACLs will be listed under any folder that may contain them (e.g., '0: group:admin allow list,readattr,reaadextattr,readsecurity'). If any such line exists, this is a finding.</check-content></check>
<rationale>Log folders must not contain ACLs.</rationale>
</Rule>

<Rule severity="high" id="Ensure the Security Assessment Policy Subsystem is Enabled">
<title>Ensure the Security Assessment Policy Subsystem is Enabled</title>
<description>To enable the Security assessment policy subsystem, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/spctl --master-enable</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">001749</reference>
<ident srgid="SRG-OS-000366" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the status of the Security assessment policy subsystem, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/spctl --status | /usr/bin/grep enabled<p/><p/>If nothing is returned, this is a finding.</check-content></check>
<rationale>The Security assessment policy subsystem must be enabled.</rationale>
</Rule>

<Rule severity="medium" id="Ensure System Integrity Protection is Enabled">
<title>Ensure System Integrity Protection is Enabled</title>
<description>To reenable System Integrity Protection, boot the affected system into Recovery Mode, launch Terminal from the Utilities menu, and run the following command:<p/><p/>/usr/bin/csrutil enable</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-5 (6)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001499</reference>
<ident srgid="SRG-OS-000259" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>System Integrity Protection is a security feature, enabled by default, that protects certain system processes and files from being modified or tampered with. The current status of System Integrity Protection can be checked with the following command:<p/><p/>/usr/bin/csrutil status<p/><p/>If the result does not show the following:<p/><p/>System Integrity Protection status: enabled.<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must limit privileges to change software resident within software libraries.</rationale>
</Rule>

<Rule severity="medium" id="Enforce Settings with a Configuration Profile">
<title>Enforce Settings with a Configuration Profile</title>
<description>Obtain a configuration profile from an MDM or trusted provider containing the configuration settings required to be applied.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the computer has a configuration profile applied to the workstation, run the following command:<p/><p/>sudo /usr/bin/profiles -H<p/><p/>If there are no /usr/bin/profiles installed, this is a finding.</check-content></check>
<rationale>A configuration profile must be installed.</rationale>
</Rule>

<Rule severity="medium" id="Configure Application Whitelisting and Only Allow Whitelisted Applications to Run">
<title>Configure Application Whitelisting and Only Allow Whitelisted Applications to Run</title>
<description>This setting is enforced using a configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 (5) (b)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001774</reference>
<ident srgid="SRG-OS-000370" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if there is a configuration policy defined for Application Restrictions, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType  | /usr/bin/grep "familyControlsEnabled = 1;"<p/><p/>If nothing is returned, this is a finding. Built-in applications such as FaceTime, Game Center, Mail, Contacts, Calendar, Reminders, and Messages should be evaluated against mission needs and should only appear in the list of allowed applications if specifically required.</check-content></check>
<rationale>The operating system must employ a deny-all, permit-by-exception policy to allow the execution of authorized software programs.</rationale>
</Rule>

<Rule severity="medium" id="Disable iCloud and Internet Accounts Preference Panes">
<title>Disable iCloud and Internet Accounts Preference Panes</title>
<description>This setting is enforced using the "Restrictions Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Access to the iCloud and Internet Accounts preference panes must be disabled. To check if the system has the correct setting in the configuration profile, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 5 'DisabledPreferencePanes'<p/><p/>If nothing is returned, this is a finding. To check if "iCloud" has been disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType  | /usr/bin/grep com.apple.preferences.icloud<p/><p/>If nothing is returned, this is a finding. To check if "Internet Accounts" has been disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType  | /usr/bin/grep com.apple.preferences.internetaccounts<p/><p/>If nothing is returned, this is a finding.</check-content></check>
<rationale>The system preference panels iCloud and Internet Accounts must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Prevent the System from Sending Diagnostic Data to Apple">
<title>Prevent the System from Sending Diagnostic Data to Apple</title>
<description>The setting "Send diagnostic &amp; usage data to Apple" is found in System Preferences &gt;&gt; Security &amp; Privacy &gt;&gt; Privacy &gt;&gt; Diagnostics &amp; Usage.<p/><p/>Uncheck the box that says 'Send diagnostic &amp; usage data to Apple.'<p/><p/>To apply the setting from the command line, run the following commands:<p/><p/>/usr/bin/defaults read "/Library/Application Support/CrashReporter/DiagnosticMessagesHistory.plist" AutoSubmit<p/><p/>/usr/bin/sudo /usr/bin/defaults write "/Library/Application Support/CrashReporter/DiagnosticMessagesHistory.plist" AutoSubmit -bool false<p/>/usr/bin/sudo /bin/chmod 644 /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist<p/>/usr/bin/sudo /usr/bin/chgrp admin /Library/Application\ Support/CrashReporter/DiagnosticMessagesHistory.plist<p/><p/>This setting can be enforced using the "Security Privacy Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000382</reference>
<ident srgid="SRG-OS-000096" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Sending diagnostic &amp; usage data to Apple must be disabled.<p/><p/>The setting is found in System Preferences &gt;&gt; Security &amp; Privacy &gt;&gt; Privacy &gt;&gt; Diagnostics &amp; Usage.<p/><p/>If the box that says 'Send diagnostic &amp; usage data to Apple' is checked, this is a finding.<p/><p/>To check if a configuration profile is configured to enforce this setting, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep AutoSubmit<p/><p/>If AutoSubmit is not set to '0', this is a finding.</check-content></check>
<rationale>Sending diagnostic and usage data to Apple must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable the 'Find My Mac' Service">
<title>Disable the 'Find My Mac' Service</title>
<description>To disable the 'Find My Mac' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.findmymacd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Find My Mac' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.findmymacd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.findmymacd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Find My Mac must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable the 'Find My Mac Messenger' Service">
<title>Disable the 'Find My Mac Messenger' Service</title>
<description>To disable the 'Find My Mac messenger' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.findmymacmessenger<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Find My Mac messenger' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.findmymacmessenger<p/><p/>If the results do not show the following:<p/><p/>"com.apple.findmymacmessenger" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Find My Mac messenger must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable Location Services">
<title>Disable Location Services</title>
<description>The setting "Enable Location Services" is found in System Preferences &gt;&gt; Security &amp; Privacy &gt;&gt; Privacy &gt;&gt; Location Services.<p/><p/>Uncheck the box that says 'Enable Location Services'.<p/><p/>This setting can be enforced using the "Custom Policy" configuration profile or with the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults write /private/var/db/locationd/Library/Preferences/ByHost/com.apple.locationd.`/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep "Hardware UUID" | /usr/bin/cut -c22-57` LocationServicesEnabled -bool false</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Location Services must be disabled. The setting is found in System Preferences &gt;&gt; Security &amp; Privacy &gt;&gt; Privacy &gt;&gt; Location Services.<p/><p/>If the box that says 'Enable Location Services' is checked, this is a finding.<p/><p/>To check if a configuration profile is configured to enforce this setting, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableLocationServices<p/><p/>If DisableLocationServices is not set to '1', this is a finding.<p/><p/>To check if the setting was applied on the command line, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults read /private/var/db/locationd/Library/Preferences/ByHost/com.apple.locationd.`/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep "Hardware UUID" | /usr/bin/cut -c22-57` LocationServicesEnabled</check-content></check>
<rationale>Location Services must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure Bonjour to Disable Multicast Advertisements">
<title>Configure Bonjour to Disable Multicast Advertisements</title>
<description>To configure Bonjour to disable multicast advertising, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true<p/><p/>The system will need to be restarted for the update to take effect.<p/></description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Bonjour multicast advertising must be disabled on the system. To check if multicast advertisements have been disabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.mDNSResponder | /usr/bin/grep NoMulticastAdvertisements<p/><p/>If nothing is returned or NoMulticastAdvertisements is not set to 1, this is a finding.</check-content></check>
<rationale>Bonjour multicast advertising must be disabled on the system.</rationale>
</Rule>

<Rule severity="medium" id="Disable the UUCP Service">
<title>Disable the UUCP Service</title>
<description>To disable the 'UUCP' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.uucp<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'UUCP' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.uucp<p/><p/>If the results do not show the following:<p/><p/>"com.apple.uucp" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The UUCP service must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Root from Logging into SSH">
<title>Prevent Root from Logging into SSH</title>
<description>In order to make sure that PermitRootLogin is disabled by sshd, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/^[\#]*PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-2 (5)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000770</reference>
<ident srgid="SRG-OS-000109" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if SSH has root logins enabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^PermitRootLogin /etc/ssh/sshd_config<p/><p/>If there is no result, or the result is set to 'yes', this is a finding.</check-content></check>
<rationale>The operating system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator.</rationale>
</Rule>

<Rule severity="medium" id="Only Enable SSH Protocol 2">
<title>Only Enable SSH Protocol 2</title>
<description>In order to make sure that 'Protocol 2' is used by sshd, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*Protocol.*/Protocol 2/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-2 (8)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001941</reference>
<ident srgid="SRG-OS-000112" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check which protocol is configured for sshd, run the following:<p/><p/>/usr/bin/sudo /usr/bin/grep ^Protocol /etc/ssh/sshd_config<p/><p/>If there is no result or the result is not '2', this is a finding.</check-content></check>
<rationale>The operating system must implement replay-resistant authentication mechanisms for network access to privileged accounts.</rationale>
</Rule>

<Rule severity="medium" id="Only Enable SSH Protocol 2">
<title>Only Enable SSH Protocol 2</title>
<description>In order to make sure that 'Protocol 2' is used by sshd, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*Protocol.*/Protocol 2/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-2 (9)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001942</reference>
<ident srgid="SRG-OS-000113" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check which protocol is configured for sshd, run the following:<p/><p/>/usr/bin/sudo /usr/bin/grep ^Protocol /etc/ssh/sshd_config<p/><p/>If there is no result or the result is not '2', this is a finding.</check-content></check>
<rationale>The operating system must implement replay-resistant authentication mechanisms for network access to non-privileged accounts.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Password Policy to Require at Least One Numeric Character">
<title>Configure the Password Policy to Require at Least One Numeric Character</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor.<p/><p/>If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;. Then, insert the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag.<p/><p/>The same text can also be used if the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; is not present.<p/><p/>&lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributePassword matches '(.*[0-9].*){1,}+'&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>                        &lt;string&gt;com.apple.policy.legacy.requiresNumeric&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>                                &lt;key&gt;minimumNumericCharacters&lt;/key&gt;<p/>&lt;integer&gt;1&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the file does contain policy settings, and the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; does exist, insert the following text after the opening &lt;array&gt; tag that comes right after it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributePassword matches '(.*[0-9].*){1,}+'&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>                &lt;string&gt;com.apple.policy.legacy.requiresNumeric&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>                        &lt;key&gt;minimumNumericCharacters&lt;/key&gt;<p/>&lt;integer&gt;1&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5 (1) (a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000194</reference>
<ident srgid="SRG-OS-000071" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with a configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system is configured to require that passwords contain at least one numeric character:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep requireAlphanumeric<p/><p/>If 'requireAlphanumeric' is not set to '1' or is undefined, this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, run the following command instead:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;. If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that 'matches' the variable 'policyAttributePassword' to the regular expression '(.*[0-9].*){1,}+' or to a similar expression that will ensure the password contains a character in the range 0-9 one or more times. If this check allows users to create passwords without at least one numeric character, or if no such check exists, this is a finding.</check-content></check>
<rationale>Operating systems must enforce password complexity by requiring that at least one numeric character be used.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Password Policy to Require at Least 15 Characters">
<title>Configure the Password Policy to Require at Least 15 Characters</title>
<description>This setting is enforced using the "Passcode Policy" configuration profile.<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5 (1) (a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000205</reference>
<ident srgid="SRG-OS-000078" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check the currently applied policies for password and accounts, use the following command:<p/><p/>/usr/bin/sudo /usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep minLength<p/><p/>The parameter minLength should be '15'.  If it is less than '15', this is a finding.</check-content></check>
<rationale>The operating system must enforce a minimum 15-character password length.</rationale>
</Rule>

<Rule severity="high" id="Disable the Telnet Service">
<title>Disable the Telnet Service</title>
<description>To disable the 'telnet' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5 (1) (c)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000197</reference>
<ident srgid="SRG-OS-000074" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'telnet' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.telnetd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must transmit only cryptographically-protected passwords.</rationale>
</Rule>

<Rule severity="high" id="Disable the Telnet Service">
<title>Disable the Telnet Service</title>
<description>To disable the 'telnet' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-4 (6)</reference>
<reference href="http://iase.disa.mil/cci/index.html">002890</reference>
<ident srgid="SRG-OS-000393" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'telnet' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.telnetd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Operating systems used for non-local maintenance sessions must implement cryptographic mechanisms to protect the integrity of non-local maintenance and diagnostic communications.</rationale>
</Rule>

<Rule severity="high" id="Disable the Telnet Service">
<title>Disable the Telnet Service</title>
<description>To disable the 'telnet' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-4 (6)</reference>
<reference href="http://iase.disa.mil/cci/index.html">003123</reference>
<ident srgid="SRG-OS-000394" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'telnet' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.telnetd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Operating systems used for non-local maintenance sessions must implement cryptographic mechanisms to protect the confidentiality of non-local maintenance and diagnostic communications.</rationale>
</Rule>

<Rule severity="high" id="Disable the Telnet Service">
<title>Disable the Telnet Service</title>
<description>To disable the 'telnet' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.telnetd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-4 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000877</reference>
<ident srgid="SRG-OS-000125" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'telnet' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.telnetd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.telnetd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The operating system must employ strong authenticators in the establishment of non-local maintenance and diagnostic sessions.</rationale>
</Rule>

<Rule severity="medium" id="Configure Gatekeeper to Only Allow Signed Applications to Run">
<title>Configure Gatekeeper to Only Allow Signed Applications to Run</title>
<description>This setting is enforced using the "Security Privacy Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">001749</reference>
<ident srgid="SRG-OS-000366" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check to make sure only applications downloaded from the App Store or from Identified Developers are allowed to run, type the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep EnableAssessment<p/><p/>If 'EnableAssessment' is not set to '1', this is a finding.<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep AllowIdentifiedDevelopers<p/><p/>If 'AllowIdentifiedDevelopers' is not set to '1', this is a finding.</check-content></check>
<rationale>The system must allow only applications downloaded from the App Store to run.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Users from Overriding Gatekeeper Settings">
<title>Prevent Users from Overriding Gatekeeper Settings</title>
<description>This setting is enforced using the "Security Privacy Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check to make sure the user cannot override Gatekeeper settings, type the following code:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableOverride<p/><p/>If DisableOverride is not set to '1', this is a finding.</check-content></check>
<rationale>End users must not be able to override Gatekeeper settings.</rationale>
</Rule>

<Rule severity="medium" id="Configure SSH Sessions to Log Out after 15 Minutes of Inactivity">
<title>Configure SSH Sessions to Log Out after 15 Minutes of Inactivity</title>
<description>In order to make sure that ClientAliveInterval is set correctly, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveInterval.*/ClientAliveInterval 600/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-10</reference>
<reference href="http://iase.disa.mil/cci/index.html">001133</reference>
<ident srgid="SRG-OS-000163" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The SSH daemon ClientAliveInterval option must be set correctly. To check the idle timeout setting for SSH sessions, run the following:<p/><p/>/usr/bin/sudo /usr/bin/grep ^ClientAliveInterval /etc/ssh/sshd_config<p/><p/>If the setting is not '600', this is a finding.</check-content></check>
<rationale>The SSH daemon ClientAliveInterval option must be set correctly.</rationale>
</Rule>

<Rule severity="medium" id="Configure SSH Sessions to Log Out after 15 Minutes of Inactivity">
<title>Configure SSH Sessions to Log Out after 15 Minutes of Inactivity</title>
<description>In order to make sure that the SSH idle timeout occurs precisely when the 'ClientAliveCountMax' is set, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveCountMax.*/ClientAliveCountMax 0/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-10</reference>
<reference href="http://iase.disa.mil/cci/index.html">001133</reference>
<ident srgid="SRG-OS-000163" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The SSH daemon ClientAliveCountMax option must be set correctly. To ensure the SSH idle timeout will occur when the 'ClientAliveCountMax' is set, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^ClientAliveCountMax /etc/ssh/sshd_config<p/><p/>If the setting is not 'ClientAliveCountMax 0', this is a finding.</check-content></check>
<rationale>The SSH daemon ClientAliveCountMax option must be set correctly.</rationale>
</Rule>

<Rule severity="medium" id="Configure SSH Sessions to Time Out Login Sessions after 30 Seconds">
<title>Configure SSH Sessions to Time Out Login Sessions after 30 Seconds</title>
<description>In order to make sure that LoginGraceTime is configured correctly, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak 's/.*LoginGraceTime.*/LoginGraceTime 30/' /etc/ssh/sshd_config</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-10</reference>
<reference href="http://iase.disa.mil/cci/index.html">001133</reference>
<ident srgid="SRG-OS-000163" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The SSH daemon LoginGraceTime must be set correctly. To check the amount of time that a user can login through SSH, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^LoginGraceTime /etc/ssh/sshd_config<p/><p/>If the value is not set to '30' or less, this is a finding.</check-content></check>
<rationale>The SSH daemon LoginGraceTime must be set correctly.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System Keychain to Include Approved Certificates">
<title>Configure the System Keychain to Include Approved Certificates</title>
<description>Obtain the approved DOD certificates from the appropriate authority. Use Keychain Access from /Applications/Utilities to add certificates to the System keychain.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">002450</reference>
<ident srgid="SRG-OS-000478" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To view a list of installed certificates, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/security dump-keychain | /usr/bin/grep labl | awk -F\" '{ print $4 }'<p/><p/>If this list does not contain approved certificates, this is a finding.</check-content></check>
<rationale>The operating system must issue or obtain public key certificates under an appropriate certificate policy from an approved service provider.</rationale>
</Rule>

<Rule severity="medium" id="Enable FileVault on Laptops">
<title>Enable FileVault on Laptops</title>
<description>Open System Preferences &gt;&gt; Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p/><p/>Alternately, from the command line, run the following command to enable FileVault:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup enable<p/><p/>After FileVault is initially set up, additional users can be added.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28</reference>
<reference href="http://iase.disa.mil/cci/index.html">001199</reference>
<ident srgid="SRG-OS-000185" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if FileVault 2 is enabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup status<p/><p/>If FileVault is 'Off' and the device is a laptop, this is a finding.</check-content></check>
<rationale>The operating system must protect the confidentiality and integrity of all information at rest.</rationale>
</Rule>

<Rule severity="medium" id="Enable FileVault on Laptops">
<title>Enable FileVault on Laptops</title>
<description>Open System Preferences &gt;&gt; Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p/><p/>Alternately, from the command line, run the following command to enable FileVault:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup enable<p/><p/>After FileVault is initially set up, additional users can be added.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">002475</reference>
<ident srgid="SRG-OS-000404" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if FileVault 2 is enabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup status<p/><p/>If FileVault is 'Off', and the device is a laptop, this is a finding.</check-content></check>
<rationale>The operating system must implement cryptographic mechanisms to prevent unauthorized modification of all information at rest on organization-defined information system components.</rationale>
</Rule>

<Rule severity="medium" id="Enable FileVault on Laptops">
<title>Enable FileVault on Laptops</title>
<description>Open System Preferences &gt;&gt; Security and Privacy, and navigate to the FileVault tab. Use this panel to configure full-disk encryption.<p/><p/>Alternately, from the command line, run the following command to enable FileVault:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup enable<p/><p/>After FileVault is initially set up, additional users can be added.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-28 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">002476</reference>
<ident srgid="SRG-OS-000405" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if FileVault 2 is enabled, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/fdesetup status<p/><p/>If FileVault is 'Off', and the device is a laptop, this is a finding.</check-content></check>
<rationale>The operating system must implement cryptographic mechanisms to prevent unauthorized disclosure of all information at rest on organization-defined information system components.</rationale>
</Rule>

<Rule severity="medium" id="Install an HBSS Solution for Network Monitoring">
<title>Install an HBSS Solution for Network Monitoring</title>
<description>Install an approved HBSS solution onto the system.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-2 (2)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001233</reference>
<ident srgid="SRG-OS-000191" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Ask the SA or ISSO if an approved tool capable of continuous scanning is loaded on the system. The recommended system is the McAfee HBSS. If no such tool is installed on the system, this is a finding.</check-content></check>
<rationale>The operating system must employ automated mechanisms to determine the state of system components with regard to flaw remediation using the following frequency: continuously, where HBSS is used; 30 days, for any additional internal network scans not covered by HBSS; and annually, for external scans by Computer Network Defense Service Provider (CNDSP).</rationale>
</Rule>

<Rule severity="medium" id="Disable External USB Hard Drives">
<title>Disable External USB Hard Drives</title>
<description>This setting is enforced using the "Restrictions Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS DCM/DLP solution is installed, this is not applicable.<p/><p/>To ensure external USB drives are disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 3 harddisk-external<p/><p/>If the option 'eject,alert' is not set for 'harddisk-external', this is a finding.</check-content></check>
<rationale>The operating system must restrict the ability of individuals to use USB storage devices.</rationale>
</Rule>

<Rule severity="medium" id="Disable the usbmux Daemon">
<title>Disable the usbmux Daemon</title>
<description>To disable the usbmuxd daemon, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.usbmuxd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the usbmuxd daemon is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.usbmuxd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.usbmuxd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The usbmuxd daemon must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable Automatic Logins">
<title>Disable Automatic Logins</title>
<description>This setting is enforced using the "Login Window Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system if configured to automatically log in, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableAutoLoginClient<p/><p/>If 'com.apple.login.mcx.DisableAutoLoginClient' is not set to '1', this is a finding.</check-content></check>
<rationale>The operating system must not allow an unattended or automatic logon to the system.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Not Display a List of Known Users at Login">
<title>Configure the System to Not Display a List of Known Users at Login</title>
<description>This setting is enforced using the "Login Window Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the login window is configured to prompt for user name and password, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep SHOWFULLNAME<p/><p/>If there is no result, or SHOWFULLNAME is not set to '1', this is a finding.</check-content></check>
<rationale>The login window must be configured to prompt for username and password, rather than show a list of users.</rationale>
</Rule>

<Rule severity="medium" id="Turn on Firewall Logging">
<title>Turn on Firewall Logging</title>
<description>To enable the firewall logging, run the following command:<p/><p/>/usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If HBSS is used, this is not applicable.<p/><p/>To check if the OS X firewall has logging enabled, run the following command:<p/><p/>/usr/libexec/ApplicationFirewall/socketfilterfw --getloggingmode | /usr/bin/grep on<p/><p/>If the result does not show 'on', this is a finding.</check-content></check>
<rationale>The OS X firewall must have logging enabled.</rationale>
</Rule>

<Rule severity="medium" id="Prevent Bluetooth Devices from Waking the Computer">
<title>Prevent Bluetooth Devices from Waking the Computer</title>
<description>This control needs to be manually changed on the computer by opening System Preferences &gt;&gt; Bluetooth, Click Advanced, and make sure the 'Allow Bluetooth devices to wake this computer' is not checked. This control is not necessary if Bluetooth has been completely disabled.<p/><p/>The following can be run from the command line to disable Remote Wake for the current user:<p/><p/>/usr/bin/defaults write /Users/`whoami`/Library/Preferences/ByHost/com.apple.Bluetooth.`/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep "Hardware UUID" | /usr/bin/cut -c22-57`.plist  RemoteWakeEnabled 0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if this setting is disabled run the following two command as the primary user:<p/><p/>/usr/bin/defaults -currentHost read com.apple.Bluetooth RemoteWakeEnabled<p/><p/>/usr/bin/defaults read /Users/`whoami`/Library/Preferences/ByHost/com.apple.Bluetooth.`/usr/sbin/system_profiler SPHardwareDataType | grep "Hardware UUID" | cut -c22-57`.plist  RemoteWakeEnabled<p/><p/>If the return value is '1' for either command, this is a finding.</check-content></check>
<rationale>Bluetooth devices must not be allowed to wake the computer.</rationale>
</Rule>

<Rule severity="medium" id="Disable Bluetooth File Sharing">
<title>Disable Bluetooth File Sharing</title>
<description>To disable Bluetooth Sharing, open System Preferences-&gt;Sharing and uncheck the box next to Bluetooth Sharing. This control is not necessary if Bluetooth has been completely disabled.<p/><p/>The following can be run from the command line to disable Bluetooth Sharing for the current user:<p/><p/>/usr/bin/defaults write /Users/`whoami`/Library/Preferences/ByHost/com.apple.Bluetooth.`/usr/sbin/system_profiler SPHardwareDataType | /usr/bin/grep "Hardware UUID" | /usr/bin/cut -c22-57`.plist  PrefKeyServicesEnabled 0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if Bluetooth Sharing is enabled, open up System Preferences-&gt;Sharing and verify that 'Bluetooth Sharing' is not checked 'ON'. If it is 'ON', this is a finding.<p/><p/>The following command can be run from the command line:<p/><p/>/usr/bin/defaults read /Users/`whoami`/Library/Preferences/ByHost/com.apple.Bluetooth.`/usr/sbin/system_profiler SPHardwareDataType | grep "Hardware UUID" | cut -c22-57`.plist  PrefKeyServicesEnabled<p/><p/>If the return value is '1', this is a finding<p/><p/></check-content></check>
<rationale>Bluetooth Sharing must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable the 'Remote Apple Events' Service">
<title>Disable the 'Remote Apple Events' Service</title>
<description>To disable the 'Remote Apple Events' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.AEServer<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000382</reference>
<ident srgid="SRG-OS-000096" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Remote Apple Events' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.AEServer<p/><p/>If the results do not show the following:<p/><p/>"com.apple.AEServer" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Remote Apple Events must be disabled.</rationale>
</Rule>

<Rule severity="high" id="Configure sudo to Request a Password Separately for Each Terminal Window">
<title>Configure sudo to Request a Password Separately for Each Terminal Window</title>
<description>Edit the /etc/sudoers file to contain the line:<p/><p/>Defaults tty_tickets<p/><p/>This line can be placed in the defaults section or at the end of the file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the tty_tickets option is set for /usr/bin/sudo, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep tty_tickets /etc/sudoers<p/><p/>If there is no result, this is a finding.</check-content></check>
<rationale>The sudoers file must be configured to authenticate users on a per-tty basis.</rationale>
</Rule>

<Rule severity="medium" id="Enable the Application Firewall">
<title>Enable the Application Firewall</title>
<description>To enable the firewall run the following command:<p/><p/>/usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If an approved HBSS solution is installed, this is not applicable.<p/><p/>To check if the OS X firewall has been enabled, run the following command:<p/><p/>/usr/bin/sudo /usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate<p/><p/>If the result is 'disabled', this is a finding.</check-content></check>
<rationale>The application firewall must be enabled.</rationale>
</Rule>

<Rule severity="medium" id="Change the Ownership of World Writable Directories to root or an Application Account">
<title>Change the Ownership of World Writable Directories to root or an Application Account</title>
<description>To change the ownership of any finding, run the following command:<p/><p/>/usr/bin/sudo find / -type d -perm +o+w -not -uid 0 -exec chown root {} \;</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To display all directories that are writable by all and not owned by root, run the following command:<p/><p/>/usr/bin/sudo find / -type d -perm +o+w -not -uid 0<p/><p/>If anything is returned, and those directories are not owned by a local admin or application account, this is a finding.</check-content></check>
<rationale>All public directories must be owned by root or an application account.</rationale>
</Rule>

<Rule severity="medium" id="Disable the finger Service">
<title>Disable the finger Service</title>
<description>To disable the 'finger' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.fingerd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'finger' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.fingerd<p/><p/>If the results do not show the following:<p/><p/>"com.apple.fingerd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>The finger service must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Enable the Sticky Bit on World Writeable Directories">
<title>Enable the Sticky Bit on World Writeable Directories</title>
<description>Run the following command to set the sticky bit on all world-writable directories:<p/><p/>/usr/bin/sudo find / -type d \( -perm -0002 -a ! -perm -1000 \) -exec chmod +t {} \;</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Run the following command to view all world-writable directories that do not have the sticky bit set:<p/><p/>/usr/bin/sudo find / -type d \( -perm -0002 -a ! -perm -1000 \)<p/><p/>If anything is returned, this is a finding.</check-content></check>
<rationale>The sticky bit must be set on all public directories.</rationale>
</Rule>

<Rule severity="medium" id="Prevent New Users from Seeing the Prompt to Enter an Apple ID at Login">
<title>Prevent New Users from Seeing the Prompt to Enter an Apple ID at Login</title>
<description>To ensure that the prompt for Apple ID and iCloud is disabled, run the following commands:<p/><p/>/usr/bin/sudo /usr/bin/defaults write  /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant DidSeeCloudSetup -bool TRUE; /usr/bin/sudo /usr/bin/defaults write /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant LastSeenCloudProductVersion '10.11'</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the prompt for Apple ID and iCloud are disabled for new users, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/defaults read /System/Library/User\ Template/English.lproj/Library/Preferences/com.apple.SetupAssistant<p/><p/>If there is no result, if it prints out that the domain "does not exist", or the results do not include 'DidSeeCloudSetup = 1 AND LastSeenCloudProductVersion = 10.11', this is a finding.</check-content></check>
<rationale>The prompt for Apple ID and iCloud must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Identify Users that Have Logged into iCloud and Make Them Sign Out">
<title>Identify Users that Have Logged into iCloud and Make Them Sign Out</title>
<description>This must be manually resolved.<p/><p/>With the affected user logged in, open System Preferences &gt;&gt; iCloud.<p/><p/>Choose 'Sign Out'.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To see if any user account has configured an Apple ID for iCloud usage, run the following command:<p/><p/>/usr/bin/sudo find /Users/ -name 'MobileMeAccounts.plist' -exec /usr/bin/defaults read '{}' \;<p/><p/>If the results show any accounts listed, this is a finding.</check-content></check>
<rationale>Users must not have Apple IDs signed into iCloud.</rationale>
</Rule>

<Rule severity="low" id="Disable iTunes Music Sharing">
<title>Disable iTunes Music Sharing</title>
<description>This setting is enforced using the "Custom Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the iTunes music sharing is disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep disableSharedMusic<p/><p/>If 'disableSharedMusic' is not set to '1', this is a finding.</check-content></check>
<rationale>iTunes Music Sharing must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Find and Remove all Setuid Executables that are not Vendor Installed">
<title>Find and Remove all Setuid Executables that are not Vendor Installed</title>
<description>Document all of the files with the setuid bit set.<p/><p/>Remove any undocumented files.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>If available, provide a list of setuids provided by a vendor. To list all of the files with the setuid bit set, run the following command to send all results to a file named suidfilelist.:<p/><p/>/usr/bin/sudo find / -perm -4000 -exec /bin/ls -ldb {} \; &gt; suidfilelist<p/><p/>If any of the files listed are not documented as needing to have the setuid bit set by the vendor, this is a finding.</check-content></check>
<rationale>All setuid executables on the system must be vendor-supplied.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Ignore IPv4 Source Routed Packets">
<title>Configure the System to Ignore IPv4 Source Routed Packets</title>
<description>To configure the system to not accept source-routed packets, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.ip.accept_sourceroute=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to accept source-routed packets, run the following command:<p/><p/>sysctl net.inet.ip.accept_sourceroute<p/><p/>If the value is not '0', this is a finding.</check-content></check>
<rationale>The system must not accept source-routed IPv4 packets.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Ignore IPv4 ICMP Redirect Messages">
<title>Configure the System to Ignore IPv4 ICMP Redirect Messages</title>
<description>To configure the system to ignore ICMP redirect messages, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.icmp.drop_redirect=1</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to ignore ICMP redirect messages, run the following command:<p/><p/>sysctl net.inet.icmp.drop_redirect<p/><p/>If the value is not '1', this is a finding.</check-content></check>
<rationale>The system must ignore IPv4 ICMP redirect messages.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Disable IPv4 Forwarding">
<title>Configure the System to Disable IPv4 Forwarding</title>
<description>To configure the system to disable IP forwarding, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.ip.forwarding=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if IP forwarding is enabled, run the following command:<p/><p/>sysctl net.inet.ip.forwarding <p/><p/>If the values are not '0', this is a finding.</check-content></check>
<rationale>IP forwarding for IPv4 must not be enabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Disable IPv6 Forwarding">
<title>Configure the System to Disable IPv6 Forwarding</title>
<description>To configure the system to disable IP forwarding, add the following line to /etc/sysctl.conf:<p/><p/>net.inet6.ip6.forwarding=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if IP forwarding is enabled, run the following command:<p/><p/>sysctl net.inet6.ip6.forwarding<p/><p/>If the values are not '0', this is a finding.</check-content></check>
<rationale>IP forwarding for IPv6 must not be enabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Not Send IPv4 Redirects">
<title>Configure the System to Not Send IPv4 Redirects</title>
<description>To configure the system to not send ICMP redirects, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.ip.redirect=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to send ICMP redirects, run the following command:<p/><p/>sysctl net.inet.ip.redirect <p/><p/>If the values are not set to '0', this is a finding.</check-content></check>
<rationale>The system must not send IPv4 ICMP redirects by default.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Not Send IPv6 ICMP Redirects">
<title>Configure the System to Not Send IPv6 ICMP Redirects</title>
<description>To configure the system to not send ICMP redirects, add the following line to /etc/sysctl.conf:<p/><p/>net.inet6.ip6.redirect=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to send ICMP redirects, run the following command:<p/><p/>sysctl net.inet6.ip6.redirect<p/><p/>If the values are not set to '0', this is a finding.</check-content></check>
<rationale>The system must not send IPv6 ICMP redirects by default.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Not Forward Source Routed Packets">
<title>Configure the System to Not Forward Source Routed Packets</title>
<description>To configure the system to not forward source-routed packets, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.ip.sourceroute=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to forward source-routed packets, run the following command:<p/><p/>sysctl net.inet.ip.sourceroute<p/><p/>If the value is not set to '0', this is a finding.</check-content></check>
<rationale>The system must prevent local applications from generating source-routed packets.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Ignore ICMP Timestamp Requests">
<title>Configure the System to Ignore ICMP Timestamp Requests</title>
<description>To disable ICMP timestamp responses, add the following line to /etc/sysctl.conf:<p/><p/>net.inet.icmp.timestamp=0</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the system is configured to process ICMP timestamp requests, run the following command:<p/><p/>sysctl net.inet.icmp.timestamp<p/><p/>If the value is not set to '0', this is a finding.</check-content></check>
<rationale>The system must not process Internet Control Message Protocol [ICMP] timestamp requests.</rationale>
</Rule>

<Rule severity="medium" id="Disable Unused Network Devices">
<title>Disable Unused Network Devices</title>
<description>To disable a network device, run the following command, substituting the name of the device in place of '&lt;networkservice&gt;':<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -setnetworkserviceenabled '&lt;networkservice&gt;' off</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To list the network devices that are enabled on the system, run the following command:<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -listallnetworkservices<p/><p/>A disabled device will have an asterisk in front of its name. If any listed device that is not in use is missing this asterisk, this is a finding.</check-content></check>
<rationale>Unused network devices must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable IPv6 if Not in Use">
<title>Disable IPv6 if Not in Use</title>
<description>Run the following command to turn off IPv6 addressing for the Ethernet interface:<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -setv6off 'Ethernet'<p/><p/>Repeat this command for each enabled interface, interface names are case sensitive.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Run the following command to check if IPv6 is enabled on any network interfaces:<p/><p/>/usr/bin/sudo /usr/sbin/networksetup -listallnetworkservices | (while read dev; do echo "$dev"; networksetup -getinfo "$dev" | /usr/bin/grep IPv6:; echo ; done)<p/><p/>If there is an enabled network interface without the setting 'IPv6: Off' and it does not require IPv6, this is a finding.</check-content></check>
<rationale>System Preferences must be securely configured so IPv6 is turned off if not being used.</rationale>
</Rule>

<Rule severity="medium" id="Disable Internet Sharing">
<title>Disable Internet Sharing</title>
<description>To disable the 'Internet Sharing' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/com.apple.NetworkSharing<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Internet Sharing' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.NetworkSharing<p/><p/>If the results do not show the following:<p/><p/>"com.apple.NetworkSharing" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Internet Sharing must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Disable Web Sharing">
<title>Disable Web Sharing</title>
<description>To disable the 'Web Sharing' service, run the following command:<p/><p/>/usr/bin/sudo /bin/launchctl disable system/org.apache.httpd<p/><p/>The system may need to be restarted for the update to take effect.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To check if the 'Web Sharing' service is disabled, use the following command:<p/><p/>/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep org.apache.httpd<p/><p/>If the results do not show the following:<p/><p/>"org.apache.httpd" =&gt; true<p/><p/>this is a finding.</check-content></check>
<rationale>Web Sharing must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts">
<title>Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>The following two lines within the configuration enforce lockout expiration to 15 minutes:<p/><p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor and ensure it contains the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag.<p/><p/>Replace &lt;dict/&gt; first with &lt;dict&gt;&lt;/dict&gt; if necessary.<p/><p/>&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>&lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>&lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">002238</reference>
<ident srgid="SRG-OS-000021" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with a configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system has the correct setting for the logon reset timer:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep 'minutesUntilFailedLoginReset'<p/><p/>If 'minutesUntilFailedLoginReset is not set to '15', this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, the variable names may vary depending on how the policy was set. To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful logon attempts, run the following command to output the password policy to the screen:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'.<p/><p/>If this does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>In the array that follows, there should one or more &lt;dict&gt; sections that describe policy checks. One should contain a &lt;string&gt; that allows users to log on if 'policyAttributeFailedAuthentications' is less than 'policyAttributeMaximumFailedAuthentications'. Under policyParameters, policyAttributeMaximumFailedAuthentications should be set to 3.<p/><p/>If 'policyAttributeMaximumFailedAuthentications' is not set to 3, this is a finding.<p/><p/>In the same check or in another &lt;dict&gt; section, there should be a &lt;string&gt; that allows users to log on if the 'policyAttributeCurrentTime' is greater than the result of adding 15 minutes (900 seconds) to 'policyAttributeLastFailedAuthenticationTime'. The check might use a variable defined in its policyParameters section.<p/><p/>If the check does not exist or if the check adds too great an amount of time, this is a finding.</check-content></check>
<rationale>The operating system must enforce an account lockout time period of 15 minutes in which three consecutive invalid logon attempts by a user are made.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts">
<title>Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor and ensure it contains the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag. Replace &lt;dict/&gt; first with &lt;dict&gt;&lt;/dict&gt; if necessary.<p/><p/>&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>                                &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>                                &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>                        &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>                                &lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>                                &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>                        &lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration or bugs in OS X may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-7 a</reference>
<reference href="http://iase.disa.mil/cci/index.html">000044</reference>
<ident srgid="SRG-OS-000021" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with a configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system has the correct setting for the number of permitted failed logon attempts:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep 'maxFailedAttempts'<p/><p/>If 'maxFailedAttempts' is not set to '3', this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, the variable names may vary depending on how the policy was set. To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful logon attempts, run the following command to output the password policy to the screen:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'.<p/><p/>If this does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>In the array that follows, there should one or more &lt;dict&gt; sections that describe policy checks. One should contain a &lt;string&gt; that allows users to log on if 'policyAttributeFailedAuthentications' is less than 'policyAttributeMaximumFailedAuthentications'. Under policyParameters, policyAttributeMaximumFailedAuthentications should be set to 3.<p/><p/>If 'policyAttributeMaximumFailedAuthentications' is not set to 3, this is a finding.<p/><p/>In the same check or in another &lt;dict&gt; section, there should be a &lt;string&gt; that allows users to log on if the 'policyAttributeCurrentTime' is greater than the result of adding 15 minutes (900 seconds) to 'policyAttributeLastFailedAuthenticationTime'. The check might use a variable defined in its policyParameters section.<p/><p/>If the check does not exist or if the check adds too great an amount of time, this is a finding.</check-content></check>
<rationale>The operating system must enforce account lockout after the limit of three consecutive invalid logon attempts by a user during a 15 minute time period.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts">
<title>Configure the System to Lock Out Users for 15 Minutes After 3 Failed Login Attempts</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor and ensure it contains the following text after the opening &lt;dict&gt; tag and before the closing &lt;/dict&gt; tag.<p/><p/>Replace &lt;dict/&gt; first with &lt;dict&gt;&lt;/dict&gt; if necessary.<p/><p/>&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>&lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryAuthentication&lt;/key&gt; already exists, the following text should be used instead and inserted after the first &lt;array&gt; tag that follows it:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;(policyAttributeFailedAuthentications &lt; policyAttributeMaximumFailedAuthentications) OR (policyAttributeCurrentTime &gt; (policyAttributeLastFailedAuthenticationTime + autoEnableInSeconds))&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Authentication Lockout&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;autoEnableInSeconds&lt;/key&gt;<p/>&lt;integer&gt;900&lt;/integer&gt;<p/>&lt;key&gt;policyAttributeMaximumFailedAuthentications&lt;/key&gt;<p/>&lt;integer&gt;3&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration or bugs in OS X may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">002238</reference>
<ident srgid="SRG-OS-000329" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with a configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system has the correct setting for the number of permitted failed logon attempts and the logon reset timer:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep 'maxFailedAttempts\|minutesUntilFailedLoginReset'<p/><p/>If 'maxFailedAttempts' is not set to '3' and 'minutesUntilFailedLoginReset is not set to '15', this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, the variable names may vary depending on how the policy was set. To check if the password policy is configured to disable an account for 15 minutes after 3 unsuccessful logon attempts, run the following command to output the password policy to the screen:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line '&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;'.<p/><p/>If this does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>In the array that follows, there should be one or more &lt;dict&gt; sections that describe policy checks. One should contain a &lt;string&gt; that allows users to log on if 'policyAttributeFailedAuthentications' is less than 'policyAttributeMaximumFailedAuthentications'. Under policyParameters, policyAttributeMaximumFailedAuthentications should be set to 3.<p/><p/>If 'policyAttributeMaximumFailedAuthentications' is not set to 3, this is a finding.<p/><p/>In the same check or in another &lt;dict&gt; section, there should be a &lt;string&gt; that allows users to log on if the 'policyAttributeCurrentTime' is greater than the result of adding 15 minutes (900 seconds) to 'policyAttributeLastFailedAuthenticationTime'. The check might use a variable defined in its policyParameters section.<p/><p/>If the check does not exist or if the check adds too great an amount of time, this is a finding.</check-content></check>
<rationale>The operating system must automatically lock the account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are exceeded.</rationale>
</Rule>

<Rule severity="medium" id="Configure the System to Shutdown if the Audit Daemon Fails">
<title>Configure the System to Shutdown if the Audit Daemon Fails</title>
<description>Edit the /etc/security/audit_control file, and change the value for policy to include the setting 'ahlt'. To programmatically do this, run the following command:<p/><p/>sudo /usr/bin/sed -i.bak '/^policy/ s/$/,ahlt/' /etc/security/audit_control; sudo /usr/sbin/audit -s</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-5 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000140</reference>
<ident srgid="SRG-OS-000047" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>To view the setting for the audit control system, run the following command:<p/><p/>sudo /usr/bin/grep ^policy /etc/security/audit_control | /usr/bin/grep ahlt<p/><p/>If there is no result, this is a finding.</check-content></check>
<rationale>The operating system must shut down by default upon audit failure (unless availability is an overriding concern).</rationale>
</Rule>

<Rule severity="high" id="Install an Approved Antivirus Program">
<title>Install an Approved Antivirus Program</title>
<description>Install an approved anti-virus solution onto the system.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000366</reference>
<ident srgid="SRG-OS-000480" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Ask the SA or ISSO if an approved anti-virus solution is loaded on the system. The anti-virus solution may be bundled with an approved host-based security solution. If there is no local anti-virus solution installed on the system, this is a finding.</check-content></check>
<rationale>The operating system must employ automated mechanisms to detect the presence of unauthorized software on organizational information systems and notify designated organizational officials in accordance with the organization-defined frequency.</rationale>
</Rule>

<Rule severity="low" id="Disable AirDrop">
<title>Disable AirDrop</title>
<description>Disabling AirDrop is enforced using the "Restrictions Policy" configuration profile.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">000381</reference>
<ident srgid="SRG-OS-000095" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>AirDrop must be disabled. To check if AirDrop has been disabled, run the following command:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep DisableAirDrop<p/><p/>If DisableAirDrop is not set to '1', this is a finding.</check-content></check>
<rationale>AirDrop must be disabled.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Kernel Module Loading and Unloading">
<title>Configure the Audit Daemon to Log Kernel Module Loading and Unloading</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000477" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Privileged access, including administrative use of the command line tools kextload and kextunload, is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records for all kernel module load, unload, and restart actions, and also for all program initiations.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Changes to File Permissions">
<title>Configure the Audit Daemon to Log Changes to File Permissions</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000463" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to modify security objects occur.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Changes to File Permissions">
<title>Configure the Audit Daemon to Log Changes to File Permissions</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000464" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to modify security levels occur.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Changes to File Permissions">
<title>Configure the Audit Daemon to Log Changes to File Permissions</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000465" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to modify categories of information (e.g., classification levels) occur.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Password Policy to Expire Passwords after 60 Days or Sooner">
<title>Configure the Password Policy to Expire Passwords after 60 Days or Sooner</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor.<p/><p/>If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;.<p/><p/>If there already is a policy block that refers to password expiration, ensure it is set to 60 days.<p/><p/>If the line '&lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;' is not present in the file, add the following text immediately after the opening &lt;dict&gt; tag in the file:<p/><p/>&lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;<p/>&lt;array&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Password Change Interval&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyAttributeExpiresEveryNDays&lt;/key&gt;<p/>&lt;integer&gt;60&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/>&lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt; is already present in the file, the following text should be added just after the opening &lt;array&gt; tag that follows the line instead:<p/><p/>&lt;dict&gt;<p/>&lt;key&gt;policyContent&lt;/key&gt;<p/>&lt;string&gt;policyAttributeCurrentTime &gt; policyAttributeLastPasswordChangeTime + (policyAttributeExpiresEveryNDays * 24 * 60 * 60)&lt;/string&gt;<p/>&lt;key&gt;policyIdentifier&lt;/key&gt;<p/>&lt;string&gt;Password Change Interval&lt;/string&gt;<p/>&lt;key&gt;policyParameters&lt;/key&gt;<p/>&lt;dict&gt;<p/>&lt;key&gt;policyAttributeExpiresEveryNDays&lt;/key&gt;<p/>&lt;integer&gt;60&lt;/integer&gt;<p/>&lt;/dict&gt;<p/>&lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5 (1) (d)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000199</reference>
<ident srgid="SRG-OS-000076" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with a configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system is configured to require users to change their passwords every 60 days:<p/><p/>/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep maxPINAgeInDays<p/><p/>If 'maxPINAgeInDays' is not set to '60' or a shorter interval, or is undefined, this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, run the following command instead:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;.<p/><p/>If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that compares the variable 'policyAttributeLastPasswordChangeTime' to the variable 'policyAttributeCurrentTime'. It may contain additional variables defined in the policyParameters section that follows it. All comparisons are done in seconds.<p/><p/>If this check allows users to log in with passwords older than 60 days, or if no such check exists, this is a finding.</check-content></check>
<rationale>Operating systems must enforce a 60-day maximum password lifetime restriction.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Password Policy to Remember the User's Five Previous Passwords to Prevent Password Reuse">
<title>Configure the Password Policy to Remember the User's Five Previous Passwords to Prevent Password Reuse</title>
<description>This setting may be enforced using the "Passcode Policy" configuration profile or by a directory server.<p/><p/>To set the password policy without a configuration profile, run the following command to save a copy of the current pwpolicy account policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies | tail -n +2 &gt; pwpolicy.plist<p/><p/>Open the generated file in a text editor. If the file does not yet contain any policy settings, replace &lt;dict/&gt; with &lt;dict&gt;&lt;/dict&gt;. If there already is a policy block that refers to password history, ensure it is set to 5. If the line '&lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;' is not present in the file, add the following text immediately after the opening &lt;dict&gt; tag in the file:<p/><p/>        &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;<p/>        &lt;array&gt;<p/>                &lt;dict&gt;<p/>                        &lt;key&gt;policyContent&lt;/key&gt;<p/>                        &lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;<p/>                        &lt;key&gt;policyIdentifier&lt;/key&gt;<p/>                        &lt;string&gt;Password History&lt;/string&gt;<p/>                        &lt;key&gt;policyParameters&lt;/key&gt;<p/>                        &lt;dict&gt;<p/>                                &lt;key&gt;policyAttributePasswordHistoryDepth&lt;/key&gt;<p/>                                &lt;integer&gt;5&lt;/integer&gt;<p/>                        &lt;/dict&gt;<p/>                &lt;/dict&gt;<p/>        &lt;/array&gt;<p/><p/>If the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt; is already present in the file, the following text should be added just after the opening &lt;array&gt; tag that follows the line instead:<p/><p/>        &lt;dict&gt;<p/>                &lt;key&gt;policyContent&lt;/key&gt;<p/>                &lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;<p/>                &lt;key&gt;policyIdentifier&lt;/key&gt;<p/>                &lt;string&gt;Password History&lt;/string&gt;<p/>                &lt;key&gt;policyParameters&lt;/key&gt;<p/>                &lt;dict&gt;<p/>                        &lt;key&gt;policyAttributePasswordHistoryDepth&lt;/key&gt;<p/>                        &lt;integer&gt;5&lt;/integer&gt;<p/>                &lt;/dict&gt;<p/>        &lt;/dict&gt;<p/><p/>After saving the file and exiting to the command prompt, run the following command to load the new policy file:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy setaccountpolicies pwpolicy.plist<p/><p/>NOTE: Updates to password restrictions must be thoroughly evaluated in a test environment. Mistakes in configuration may block password change and local user creation operations, as well as, lock out all local users, including administrators.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5 (1) (e)</reference>
<reference href="http://iase.disa.mil/cci/index.html">000200</reference>
<ident srgid="SRG-OS-000077" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Password policy can be set with the "Passcode Policy" configuration profile or the pwpolicy utility. If password policy is set with a configuration profile, run the following command to check if the system is configured to require that users cannot reuse one of their five previously used passwords:<p/><p/>system_profiler SPConfigurationProfileDataType | /usr/bin/grep pinHistory<p/><p/>If 'pinHistory' is not set to '5' or higher, or is undefined, this is a finding.<p/><p/>If password policy is set with the pwpolicy utility, run the following command instead:<p/><p/>/usr/bin/sudo /usr/bin/pwpolicy getaccountpolicies<p/><p/>Look for the line &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;. If it does not exist, and password policy is not controlled by a directory server, this is a finding.<p/><p/>Otherwise, in the array section that follows it, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; such as '&lt;string&gt;none policyAttributePasswordHashes in policyAttributePasswordHistory&lt;/string&gt;'. This searches for the hash of the user-entered password in the list of previous password hashes. In the policyParameters section that follows it, policyAttributePasswordHistoryDepth must be set to 5 or greater. If this parameter is not set to 5 or greater, or if no such check exists, this is a finding.</check-content></check>
<rationale>The operating system must prohibit password reuse for a minimum of five generations.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Changes to File Permissions">
<title>Configure the Audit Daemon to Log Changes to File Permissions</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000466" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Changes to file permissions are logged by way of the 'fm' flag.  If 'fm' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to delete privileges occur.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Administrative Commands and Logins">
<title>Configure the Audit Daemon to Log Administrative Commands and Logins</title>
<description>To set the audit flags to the recommended setting, run the following command to add the flags 'lo', 'ad', and 'aa' all at once:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,lo,ad,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000064" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>The options to configure the audit daemon are located in the /etc/security/audit_control file. To view the current settings, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>If the 'lo', 'ad', and 'aa' options are not set, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to access privileges occur.</rationale>
</Rule>

<Rule severity="medium" id="Change the Ownership of System Log Files to root and Group Ownership to wheel or admin">
<title>Change the Ownership of System Log Files to root and Group Ownership to wheel or admin</title>
<description>For any log file that returns an incorrect owner or group value, run the following command:<p/><p/>/usr/bin/sudo chown root:wheel [log file]<p/><p/>[log file] is the full path to the log file in question. If the file is managed by newsyslog, find the configuration line in the directory /etc/newsyslog.d/ or the file /etc/newsyslog.conf and ensure that the owner:group column is set to root:wheel or the appropriate service user account and group. If the file is managed by aslmanager, find the configuration line in the directory /etc/asl/ or the file /etc/asl.conf and ensure that uid and gid options are either not present or are set to a service user account and group respectively.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">001314</reference>
<ident srgid="SRG-OS-000206" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>Log files are controlled by newsyslog and aslmanager.<p/><p/>These commands check for log files that exist on the system and print out the log with corresponding ownership. Run them from inside /var/log:<p/><p/>/usr/bin/sudo stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }') 2&gt; /dev/null<p/>/usr/bin/sudo stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | awk '{ print $2 }') 2&gt; /dev/null<p/><p/>If there are any system log files that are not owned by root and group-owned by wheel or admin, this is a finding. Service logs may be owned by the service user account or group.</check-content></check>
<rationale>System log files must be owned by root and group-owned by wheel or admin.</rationale>
</Rule>

<Rule severity="medium" id="Change the Permissions of System Log Files to 640 or Less Permissive">
<title>Change the Permissions of System Log Files to 640 or Less Permissive</title>
<description>For any log file that returns an incorrect permission value, run the following command:<p/><p/>/usr/bin/sudo chmod 640 [log file]<p/><p/>[log file] is the full path to the log file in question. If the file is managed by newsyslog, find the configuration line in the directory /etc/newsyslog.d/ or the file /etc/newsyslog.conf and edit the mode column to be 640 or less permissive. If the file is managed by aslmanager, find the configuration line in the directory /etc/asl/ or the file /etc/asl.conf and add or edit the mode option to be 'mode=0640' or less permissive.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">001314</reference>
<ident srgid="SRG-OS-000206" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>These commands check for log files that exist on the system and print out the log with corresponding permissions. Run them from inside /var/log:<p/><p/>/usr/bin/sudo stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }') 2&gt; /dev/null<p/>/usr/bin/sudo stat -f '%A:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | awk '{ print $2 }') 2&gt; /dev/null<p/><p/>The correct permissions on log files should be '640' or less permissive for system logs. Any file with more permissive settings is a finding.</check-content></check>
<rationale>System log files must be mode 640 or less permissive.</rationale>
</Rule>

<Rule severity="medium" id="Change the Permissions of System Log Files to Remove ACLs">
<title>Change the Permissions of System Log Files to Remove ACLs</title>
<description>For any log file that returns an ACL, run the following command:<p/><p/>/usr/bin/sudo chmod -N [log file]<p/><p/>[log file] is the full path to the log file in question.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-11 b</reference>
<reference href="http://iase.disa.mil/cci/index.html">001314</reference>
<ident srgid="SRG-OS-000206" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>These commands check for log files that exist on the system and print out the list of ACLs if there are any.<p/><p/>/usr/bin/sudo ls -ld@ $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | awk '{ print $1 }') 2&gt; /dev/null<p/>/usr/bin/sudo ls -ld@ $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | awk '{ print $2 }') 2&gt; /dev/null<p/><p/>ACLs will be listed under any file that may contain them, i.e., '0: group:admin allow list,readattr,reaadextattr,readsecurity'.<p/><p/>If any system log file contains this information, this is a finding.</check-content></check>
<rationale>ACLs for system log files must be set correctly.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Changes to File Permissions and Unsuccessful Attempts to Read and Write Files">
<title>Configure the Audit Daemon to Log Changes to File Permissions and Unsuccessful Attempts to Read and Write Files</title>
<description>To set the audit flags to the recommended setting, run the following command to add the flags 'lo', 'ad', and 'aa' all at once:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,lo,ad,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-5 (1)</reference>
<reference href="http://iase.disa.mil/cci/index.html">001814</reference>
<ident srgid="SRG-OS-000365" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Enforcement actions are logged by way of the 'fm' flag, which audits permission changes, and '-fr' and '-fw', which denote failed attempts to read or write to a file. If 'fm', '-fr', and '-fw' are not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must audit the enforcement actions used to restrict access associated with changes to the system.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Administrative Commands">
<title>Configure the Audit Daemon to Log Administrative Commands</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">MA-4 (1) (a)</reference>
<reference href="http://iase.disa.mil/cci/index.html">002884</reference>
<ident srgid="SRG-OS-000392" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Administrative actions and changes to configuration settings are logged by way of the 'ad' flag. If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>Operating systems sessions must audit non-local maintenance and diagnostic sessions organization-defined audit events.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Administrative Commands">
<title>Configure the Audit Daemon to Log Administrative Commands</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6 (9)</reference>
<reference href="http://iase.disa.mil/cci/index.html">002234</reference>
<ident srgid="SRG-OS-000327" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Privileged access is logged via the 'ad' flag.  If 'ad' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must audit the execution of privileged functions.</rationale>
</Rule>

<Rule severity="medium" id="Configure the Audit Daemon to Log Logins">
<title>Configure the Audit Daemon to Log Logins</title>
<description>To make sure the appropriate flags are enabled for auditing, run the following command:<p/><p/>/usr/bin/sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s<p/><p/>A text editor may also be used to implement the required updates to the /etc/security/audit_control file.</description>
<reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AU-12 c</reference>
<reference href="http://iase.disa.mil/cci/index.html">000172</reference>
<ident srgid="SRG-OS-000462" />
<status>Applicable - Configurable</status>
<check system="ocil-transitional"><check-content>In order to view the currently configured flags for the audit daemon, run the following command:<p/><p/>/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control<p/><p/>Attempts to log in as another user are logged by way of the 'lo' flag. If 'lo' is not listed in the result of the check, this is a finding.</check-content></check>
<rationale>The operating system must generate audit records when successful/unsuccessful attempts to modify privileges occur.</rationale>
</Rule>

</Benchmark>